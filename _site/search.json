[
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "About this site\n\n1 + 1\n\n[1] 2"
  },
  {
    "objectID": "Hands-on_exercise/Hands-on_EX01/Hands-on_EX01.html",
    "href": "Hands-on_exercise/Hands-on_EX01/Hands-on_EX01.html",
    "title": "Hands-on Exercise 1",
    "section": "",
    "text": "Getting Started\n\nInstall and launch R packages\nThe code chunk below uses p_load() of pacman package to check if tidyverse packages have been installed.\nThe code chunk below will import the library one by one\n\nlibrary(readr)\nlibrary(dplyr)\n\n\nAttaching package: 'dplyr'\n\n\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n\n\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n\nlibrary(tidyr)\n\nAlternatively, we can load all using p_load, this is more effective:\n\npacman::p_load(tidyverse)\n\n\n\nImporting the data\n\nexam_data <- read_csv(\"Exam_data.csv\")\n\nRows: 322 Columns: 7\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (4): ID, CLASS, GENDER, RACE\ndbl (3): ENGLISH, MATHS, SCIENCE\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\n\n\n\nPlotting a bar chart"
  },
  {
    "objectID": "Hands-on_exercise/Hands-on_EX02/Hands-on_EX02.html",
    "href": "Hands-on_exercise/Hands-on_EX02/Hands-on_EX02.html",
    "title": "Hands-on Exercise 2: Creating Elegant Graphics with ggplot2",
    "section": "",
    "text": "pacman::p_load(tidyverse, patchwork, \n               ggthemes, hrbrthemes, \n               ggrepel)"
  },
  {
    "objectID": "Hands-on_exercise/Hands-on_EX02/Hands-on_EX02.html#importing-the-dataset",
    "href": "Hands-on_exercise/Hands-on_EX02/Hands-on_EX02.html#importing-the-dataset",
    "title": "Hands-on Exercise 2: Creating Elegant Graphics with ggplot2",
    "section": "Importing the dataset",
    "text": "Importing the dataset\n\nexam_data <- read_csv(\"Exam_data.csv\")"
  },
  {
    "objectID": "Hands-on_exercise/Hands-on_EX02/Hands-on_EX02.html#drawing-a-scatter-plot",
    "href": "Hands-on_exercise/Hands-on_EX02/Hands-on_EX02.html#drawing-a-scatter-plot",
    "title": "Hands-on Exercise 2: Creating Elegant Graphics with ggplot2",
    "section": "Drawing a scatter plot",
    "text": "Drawing a scatter plot\n\nggplot(data=exam_data, \n       aes(x=MATHS, y=ENGLISH))+\n  geom_point()+\n  coord_cartesian(xlim=c(0,100),\n                  ylim=c(0,100))+\n  geom_smooth(method=lm,size=0.5)+\n  geom_label_repel(aes(label=ID),fontface=\"bold\")+\n  theme_bw()+\n  ggtitle(\"English Scores vs Maths Scores for Primary 3 Students\")+ \n  theme(plot.title = element_text(size=15, hjust = 0.5))"
  },
  {
    "objectID": "Hands-on_exercise/Hands-on_EX02/Hands-on_EX02.html#plotting-a-histogram",
    "href": "Hands-on_exercise/Hands-on_EX02/Hands-on_EX02.html#plotting-a-histogram",
    "title": "Hands-on Exercise 2: Creating Elegant Graphics with ggplot2",
    "section": "Plotting a histogram",
    "text": "Plotting a histogram\n\nggplot(exam_data, \n       aes(x=MATHS))+\n  geom_histogram(bins=20,\n                 boundary=100,\n                 color=\"grey10\",\n                 fill=\"grey45\")+\n  theme_ipsum(base_size=12, grid=\"Y\") +\n  ggtitle(\"Distribution of Maths scores\")+\n  theme(plot.title = element_text(size=15, hjust = 0.5))"
  },
  {
    "objectID": "Hands-on_exercise/Hands-on_EX02/Hands-on_EX02.html#creating-composite-plot-using-patchwork",
    "href": "Hands-on_exercise/Hands-on_EX02/Hands-on_EX02.html#creating-composite-plot-using-patchwork",
    "title": "Hands-on Exercise 2: Creating Elegant Graphics with ggplot2",
    "section": "Creating composite plot using patchwork",
    "text": "Creating composite plot using patchwork\n\np1 <- ggplot(data=exam_data, \n             aes(x = MATHS)) +\n  geom_histogram(bins=20, \n                 boundary = 100,\n                 color=\"grey25\", \n                 fill=\"grey60\") + \n  coord_cartesian(xlim=c(0,100)) +\n  ggtitle(\"Distribution of Maths scores\")\n\np2 <- ggplot(data=exam_data, \n             aes(x = ENGLISH)) +\n  geom_histogram(bins=20, \n                 boundary = 100,\n                 color=\"grey25\", \n                 fill=\"grey60\") +\n  coord_cartesian(xlim=c(0,100)) +\n  ggtitle(\"Distribution of English scores\")\n\np3 <- ggplot(data=exam_data, \n             aes(x= MATHS, \n                 y=ENGLISH)) +\n  geom_point() +\n  geom_smooth(method=lm, \n              size=0.5) +  \n  coord_cartesian(xlim=c(0,100),\n                  ylim=c(0,100)) +\n  ggtitle(\"English scores versus Maths scores for Primary 3\")\n\npatchwork <- ((p1 + p2) / p3) + plot_annotation(tag_levels = \"I\")\npatchwork & theme_clean()"
  },
  {
    "objectID": "Hands-on_exercise/Hands-on_EX03/Hands-on_EX03.html",
    "href": "Hands-on_exercise/Hands-on_EX03/Hands-on_EX03.html",
    "title": "Hands-on Exercise 3",
    "section": "",
    "text": "Installing and loading R packages\nTwo packages (tidyverse and ggiraph) are installed and loaded.\n\npacman::p_load(ggplot2, ggiraph, grid, tidyverse, patchwork)\n\n\n\nImporting data\n\nexam_data <- read_csv(\"Exam_data.csv\")\n\n\n\nPlot a static dotplot with ggplot\n\nggplot(data=exam_data, \n       aes(x = MATHS)) +\n  geom_dotplot(binwidth=2.5, \n               dotsize = 0.5) +\n  scale_y_continuous(NULL, \n                     breaks = NULL)\n\n\n\n\n\n\nPlot an interactive dotplot with ggirafe\n\np <- ggplot(data=exam_data, \n       aes(x = MATHS)) +\n  geom_dotplot_interactive(             \n    aes(tooltip = ID),                   \n    stackgroups = TRUE,                  \n    binwidth = 1,                        \n    method = \"histodot\") +               \n  scale_y_continuous(NULL,               \n                     breaks = NULL)\ngirafe(                                  \n  ggobj = p,                             \n  width_svg = 6,                         \n  height_svg = 6*0.618   \n)\n\n\n\n\n\n\n\nDisplay multiple information on tooltip\n\nexam_data$tooltip <- c(paste0(     \n  \"Name = \", exam_data$ID,         \n  \"\\n Class = \", exam_data$CLASS)) \n\np <- ggplot(data=exam_data, \n       aes(x = MATHS)) +\n  geom_dotplot_interactive(\n    aes(tooltip = exam_data$tooltip), \n    stackgroups = TRUE,\n    binwidth = 1,\n    method = \"histodot\") +\n  scale_y_continuous(NULL,               \n                     breaks = NULL)\ngirafe(\n  ggobj = p,\n  width_svg = 8,\n  height_svg = 8*0.618\n)\n\n\n\n\n\n\n\nCustomizing tooltip style\n\ntooltip_css <- \"background-color:yellow; \nfont-style:bold; color:black;\" \n\nexam_data$tooltip <- c(paste0(     \n  \"Name = \", exam_data$ID,         \n  \"\\n Class = \", exam_data$CLASS)) \n\np <- ggplot(data=exam_data, \n       aes(x = MATHS)) +\n  geom_dotplot_interactive(              \n    aes(tooltip = exam_data$tooltip),                   \n    stackgroups = TRUE,                  \n    binwidth = 1,                        \n    method = \"histodot\") +               \n  scale_y_continuous(NULL,               \n                     breaks = NULL)\ngirafe(                                  \n  ggobj = p,                             \n  width_svg = 6,                         \n  height_svg = 6*0.618,\n  options = list(    \n    opts_tooltip(    \n      css = tooltip_css)) \n)                                     \n\n\n\n\n\n\n\nAdding hover effect with data_id aesthetic - highlighting the same class\n\np <- ggplot(data=exam_data, \n       aes(x = MATHS)) +\n  geom_dotplot_interactive(           \n    aes(data_id = CLASS),  \n    stackgroups = TRUE,               \n    binwidth = 1,                        \n    method = \"histodot\") +               \n  scale_y_continuous(NULL,               \n                     breaks = NULL)\ngirafe(                                  \n  ggobj = p,                             \n  width_svg = 6,                         \n  height_svg = 6*0.618                      \n)\n\n\n\n\n\n\n\nStyling hover effect\n\np <- ggplot(data=exam_data, \n       aes(x = MATHS)) +\n  geom_dotplot_interactive(              \n    aes(data_id = CLASS),              \n    stackgroups = TRUE,                  \n    binwidth = 1,                        \n    method = \"histodot\") +               \n  scale_y_continuous(NULL,               \n                     breaks = NULL)\ngirafe(                                  \n  ggobj = p,                             \n  width_svg = 6,                         \n  height_svg = 6*0.618,\n  options = list(                       \n    opts_hover(css = \"fill: #202020;\"), \n    opts_hover_inv(css = \"opacity:0.2;\")\n  )\n)\n\n\n\n\n\n\n\nCombining tooltip and hover effect\n\ntooltip_css <- \"background-color:#ffdab9; \nfont-style:bold; color:black;\" \n\nexam_data$tooltip <- c(paste0(     \n  \"Name = \", exam_data$ID,         \n  \"\\n Class = \", exam_data$CLASS)) \n\np <- ggplot(data=exam_data, \n       aes(x = MATHS)) +\n  geom_dotplot_interactive(              \n    aes(tooltip = exam_data$tooltip, #<<\n        data_id = CLASS),#<<              \n    stackgroups = TRUE,                  \n    binwidth = 1,                        \n    method = \"histodot\") +               \n  scale_y_continuous(NULL,               \n                     breaks = NULL)\ngirafe(                                  \n  ggobj = p,                             \n  width_svg = 6,                         \n  height_svg = 6*0.618,\n  options = list(                        \n    opts_hover(css = \"fill: #202020;\"),  \n    opts_hover_inv(css = \"opacity:0.2;\"),\n    opts_tooltip(    \n      css = tooltip_css)\n  )                                        \n)\n\n\n\n\n\n\n\nCoordinating multiple views with ggiraph\nWhen hovering over a data point of one of the dotplot, the related data point on the second data visualisation will be highlighted too.\n\nexam_data$tooltip <- c(paste0(     \n  \"Name = \", exam_data$ID,         \n  \"\\n Class = \", exam_data$CLASS)) \n\np1 <- ggplot(data=exam_data, \n       aes(x = MATHS)) +\n  geom_dotplot_interactive(              \n    aes(data_id = ID, tooltip = exam_data$tooltip),              \n    stackgroups = TRUE,                  \n    binwidth = 1,                        \n    method = \"histodot\") +  \n  coord_cartesian(xlim=c(0,100)) + \n  scale_y_continuous(NULL,               \n                     breaks = NULL)\n\n\np2 <- ggplot(data=exam_data, \n       aes(x = ENGLISH)) +\n  geom_dotplot_interactive(              \n    aes(data_id = ID, tooltip = exam_data$tooltip),              \n    stackgroups = TRUE,                  \n    binwidth = 1,                        \n    method = \"histodot\") + \n  coord_cartesian(xlim=c(0,100)) + \n  scale_y_continuous(NULL,               \n                     breaks = NULL)\n\npatch = wrap_elements((p1) / p2)\ngirafe(ggobj = patch, \n       width_svg = 6,\n       height_svg = 5,\n       options = list(\n         opts_hover(css = \"fill: #202020;\"),\n         opts_hover_inv(css = \"opacity:0.2;\")\n         )\n       )"
  },
  {
    "objectID": "Hands-on_exercise/Hands-on_EX04/Hands-on_EX04.html",
    "href": "Hands-on_exercise/Hands-on_EX04/Hands-on_EX04.html",
    "title": "Hands-on Exercise 4",
    "section": "",
    "text": "Loading required packages\n\npacman::p_load(ggstatsplot, tidyverse)\n\n\n\nImporting data\n\nexam <- read_csv(\"data/Exam_data.csv\")\n\n\n\nOne-sample test: gghistostats() method\nUse gghistostats() to build a visual of one-sample test on English scores.\n\nset.seed(1234)\n\ngghistostats(\n  data = exam,\n  x = ENGLISH,\n  type = \"bayes\",\n  test.value = 60,\n  xlab = \"English scores\"\n)\n\n\n\n\n\n\nTwo-sample mean test: ggbetweenstats()\nUse ggbetweenstats() to build a visual for two-sample mean test of Maths scores by gender.\n\nggbetweenstats(\n  data = exam,\n  x = GENDER, \n  y = MATHS,\n  type = \"np\",\n  messages = FALSE\n)\n\n\n\n\n\n\nOneway ANOVA Test: ggbetweenstats() method\nUse ggbetweenstats() to build a visual for One-way ANOVA test on English score by race.\n\nggbetweenstats(\n  data = exam,\n  x = RACE, \n  y = ENGLISH,\n  type = \"p\",\n  mean.ci = TRUE, \n  pairwise.comparisons = TRUE, \n  pairwise.display = \"s\",\n  p.adjust.method = \"fdr\",\n  messages = FALSE\n)\n\n\n\n\n\n\nSignificant Test of Correlation: ggscatterstats()\nUse ggscatterstats() to build a visual for Significant Test of Correlation between Maths scores and English scores.\n\nggscatterstats(\n  data = exam,\n  x = MATHS,\n  y = ENGLISH,\n  marginal = FALSE,\n  )"
  },
  {
    "objectID": "In-class_Exercise/Hands-on_Ex06-VisTime.html",
    "href": "In-class_Exercise/Hands-on_Ex06-VisTime.html",
    "title": "Hands-on Exercise 6: Visualising and Analysing Time-oriented Data",
    "section": "",
    "text": "By the end of this hands-on exercise you will be able create the followings data visualisation by using R packages:\n\nplotting a calender heatmap by using ggplot2 functions,\nplotting a cycle plot by using ggplot2 function,\nplotting a horizon chart"
  },
  {
    "objectID": "In-class_Exercise/Hands-on_Ex06-VisTime.html#getting-started",
    "href": "In-class_Exercise/Hands-on_Ex06-VisTime.html#getting-started",
    "title": "Hands-on Exercise 6: Visualising and Analysing Time-oriented Data",
    "section": "Getting Started",
    "text": "Getting Started\n::: callout-info ## Do It Yourself Write a code chunk to check, install and launch the following R packages: scales, viridis, lubridate, ggthemes, gridExtra, readxl, knitr, data.table and tidyverse.\n\n\nShow the code\npacman::p_load(scales, viridis, lubridate, ggthemes, gridExtra, tidyverse, readxl, knitr, data.table)"
  },
  {
    "objectID": "In-class_Exercise/Hands-on_Ex06-VisTime.html#plotting-calendar-heatmap",
    "href": "In-class_Exercise/Hands-on_Ex06-VisTime.html#plotting-calendar-heatmap",
    "title": "Hands-on Exercise 6: Visualising and Analysing Time-oriented Data",
    "section": "Plotting Calendar Heatmap",
    "text": "Plotting Calendar Heatmap\nIn this section, you will learn how to plot a calender heatmap programmetically by using ggplot2 package.\n\nBy the end of this section, you will be able to:\n\nplot a calender heatmap by using ggplot2 functions and extension,\nto write function using R programming,\nto derive specific date and time related field by using base R and lubridate packages\nto perform data preparation task by using tidyr and dplyr packages.\n\n\nThe Data\nFor the purpose of this hands-on exercise, eventlog.csv file will be used. This data file consists of 199,999 rows of time-series cyber attack records by country.\n\n\nImporting the data\nFirst, you will use the code chunk below to import eventlog.csv file into R environment and called the data frame as attacks.\n\nattacks <- read_csv(\"data/eventlog.csv\")\n\n\n\nExamining the data structure\nIt is always a good practice to examine the imported data frame before further analysis is performed.\nFor example, kable() can be used to review the structure of the imported data frame.\n\nkable(head(attacks))\n\n\n\n\ntimestamp\nsource_country\ntz\n\n\n\n\n2015-03-12 15:59:16\nCN\nAsia/Shanghai\n\n\n2015-03-12 16:00:48\nFR\nEurope/Paris\n\n\n2015-03-12 16:02:26\nCN\nAsia/Shanghai\n\n\n2015-03-12 16:02:38\nUS\nAmerica/Chicago\n\n\n2015-03-12 16:03:22\nCN\nAsia/Shanghai\n\n\n2015-03-12 16:03:45\nCN\nAsia/Shanghai\n\n\n\n\n\nThere are three columns, namely timestamp, source_country and tz.\n\ntimestamp field stores date-time values in POSIXct format.\nsource_country field stores the source of the attack. It is in ISO 3166-1 alpha-2 country code.\n\ntz field stores time zone of the source IP address.\n\n\n\n\n\n\ntimestamp\nsource_country\ntz\n\n\n\n\n2015-03-12 15:59:16\nCN\nAsia/Shanghai\n\n\n2015-03-12 16:00:48\nFR\nEurope/Paris\n\n\n2015-03-12 16:02:26\nCN\nAsia/Shanghai\n\n\n2015-03-12 16:02:38\nUS\nAmerica/Chicago\n\n\n2015-03-12 16:03:22\nCN\nAsia/Shanghai\n\n\n2015-03-12 16:03:45\nCN\nAsia/Shanghai\n\n\n\n\n\n\n\nData Preparation\nStep 1: Deriving weekday and hour of day fields\nBefore we can plot the calender heatmap, two new fields namely wkday and hour need to be derived. In this step, we will write a function to perform the task.\n\nmake_hr_wkday <- function(ts, sc, tz) {\n  real_times <- ymd_hms(ts, \n                        tz = tz[1], \n                        quiet = TRUE)\n  dt <- data.table(source_country = sc,\n                   wkday = weekdays(real_times),\n                   hour = hour(real_times))\n  return(dt)\n  }\n\nNote: ymd_hms() and hour() are from lubridate package and weekdays() is a base R function.\nStep 2: Deriving the attacks tibble data frame\n\nwkday_levels <- c('Saturday', 'Friday', \n                  'Thursday', 'Wednesday', \n                  'Tuesday', 'Monday', \n                  'Sunday')\n\nattacks <- attacks %>%\n  group_by(tz) %>%\n  do(make_hr_wkday(.$timestamp, \n                   .$source_country, \n                   .$tz)) %>% \n  ungroup() %>% \n  mutate(wkday = factor(\n    wkday, levels = wkday_levels),\n    hour  = factor(\n      hour, levels = 0:23))\n\nNote: Beside extracting the necessary data into attacks data frame, mutate() of dplyr package is used to convert wkday and hour fields into factor so they’ll be ordered when plotting\nTable below shows the tidy tibble table after processing.\n\nkable(head(attacks))\n\n\n\n\ntz\nsource_country\nwkday\nhour\n\n\n\n\nAfrica/Cairo\nBG\nSaturday\n20\n\n\nAfrica/Cairo\nTW\nSunday\n6\n\n\nAfrica/Cairo\nTW\nSunday\n8\n\n\nAfrica/Cairo\nCN\nSunday\n11\n\n\nAfrica/Cairo\nUS\nSunday\n15\n\n\nAfrica/Cairo\nCA\nMonday\n11\n\n\n\n\n\n\n\nBuilding the Calendar Heatmaps\n\ngrouped <- attacks %>% \n  count(wkday, hour) %>% \n  ungroup() %>%\n  na.omit()\n\nggplot(grouped, \n       aes(hour, \n           wkday, \n           fill = n)) + \ngeom_tile(color = \"white\", \n          size = 0.1) + \ntheme_tufte(base_family = \"Helvetica\") + \ncoord_equal() +\nscale_fill_gradient(name = \"# of attacks\",\n                    low = \"sky blue\", \n                    high = \"dark blue\") +\nlabs(x = NULL, \n     y = NULL, \n     title = \"Attacks by weekday and time of day\") +\ntheme(axis.ticks = element_blank(),\n      plot.title = element_text(hjust = 0.5),\n      legend.title = element_text(size = 8),\n      legend.text = element_text(size = 6) )\n\n\n\n\nThings to learn from the code chunk: - a tibble data table called grouped is derived by aggregating the attack by wkday and hour fields. - a new field called n is derived by using group_by() and count() functions. - na.omit() is used to exclude missing value. - geom_tile() is used to plot tiles (grids) at each x and y position. color and size arguments are used to specify the border color and line size of the tiles. - theme_tufte() of ggthemes package is used to remove unnecessary chart junk. To learn which visual components of default ggplot2 have been excluded, you are encouraged to comment out this line to examine the default plot. - coord_equal() is used to ensure the plot will have an aspect ratio of 1:1. - scale_fill_gradient() function is used to creates a two colour gradient (low-high).\n\n\n\n\n\nThen we can simply group the count by hour and wkday and plot it, since we know that we have values for every combination there’s no need to further preprocess the data.\n\n\nBuilding Multiple Calendar Heatmaps\nChallenge: Building multiple heatmaps for the top four countries with the highest number of attacks.\n\n\n\nPlotting Multiple Calendar Heatmaps\nStep 1: Deriving attack by country object\nIn order to identify the top 4 countries with the highest number of attacks, you are required to do the followings:\n\ncount the number of attacks by country,\ncalculate the percent of attackes by country, and\nsave the results in a tibble data frame.\n\n\nattacks_by_country <- count(\n  attacks, source_country) %>%\n  mutate(percent = percent(n/sum(n))) %>%\n  arrange(desc(n))\n\nStep 2: Preparing the tidy data frame\nIn this step, you are required to extract the attack records of the top 4 countries from attacks data frame and save the data in a new tibble data frame (i.e. top4_attacks).\n\ntop4 <- attacks_by_country$source_country[1:4]\ntop4_attacks <- attacks %>%\n  filter(source_country %in% top4) %>%\n  count(source_country, wkday, hour) %>%\n  ungroup() %>%\n  mutate(source_country = factor(\n    source_country, levels = top4)) %>%\n  na.omit()\n\n\n\nPlotting Multiple Calendar Heatmaps\nStep 3: Plotting the Multiple Calender Heatmap by using ggplot2 package.\n\nggplot(top4_attacks, \n       aes(hour, \n           wkday, \n           fill = n)) + \n  geom_tile(color = \"white\", \n          size = 0.1) + \n  theme_tufte(base_family = \"Helvetica\") + \n  coord_equal() +\n  scale_fill_gradient(name = \"# of attacks\",\n                    low = \"sky blue\", \n                    high = \"dark blue\") +\n  facet_wrap(~source_country, ncol = 2) +\n  labs(x = NULL, y = NULL, \n     title = \"Attacks on top 4 countries by weekday and time of day\") +\n  theme(axis.ticks = element_blank(),\n        axis.text.x = element_text(size = 7),\n        plot.title = element_text(hjust = 0.5),\n        legend.title = element_text(size = 8),\n        legend.text = element_text(size = 6) )"
  },
  {
    "objectID": "In-class_Exercise/Hands-on_Ex06-VisTime.html#cycle-plot",
    "href": "In-class_Exercise/Hands-on_Ex06-VisTime.html#cycle-plot",
    "title": "Hands-on Exercise 6: Visualising and Analysing Time-oriented Data",
    "section": "Cycle Plot",
    "text": "Cycle Plot\nIn this section, you will learn how to plot a cycle plot showing the time-series patterns and trend of visitor arrivals from Vietnam programmatically by using ggplot2 functions.\n\n\nData Preparation\n\nStep 1: Data Import\nFor the purpose of this hands-on exercise, arrivals_by_air.xlsx will be used.\nThe code chunk below imports arrivals_by_air.xlsx by using read_excel() of readxl package and save it as a tibble data frame called air.\n\nair <- read_excel(\"data/arrivals_by_air.xlsx\")\n\n\n\nStep 2: Deriving month and year fields\nNext, two new fields called month and year are derived from Month-Year field.\n\nair$month <- factor(month(air$`Month-Year`), \n                    levels=1:12, \n                    labels=month.abb, \n                    ordered=TRUE) \nair$year <- year(ymd(air$`Month-Year`))\n\n\n\nStep 4: Extracting the target country\nNext, the code chunk below is use to extract data for the target country (i.e. Vietnam)\n\nVietnam <- air %>% \n  select(`Vietnam`, \n         month, \n         year) %>%\n  filter(year >= 2010)\n\n\n\nStep 5: Computing year average arrivals by month\nThe code chunk below uses group_by() and summarise() of dplyr to compute year average arrivals by month.\n\nhline.data <- Vietnam %>% \n  group_by(month) %>%\n  summarise(avgvalue = mean(`Vietnam`))\n\n\n\n\nPlotting the cycle plot\nThe code chunk below is used to plot the cycle plot as shown in Slide 12/23.\n\nggplot() + \n  geom_line(data=Vietnam,\n            aes(x=year, \n                y=`Vietnam`, \n                group=month), \n            colour=\"black\") +\n  geom_hline(aes(yintercept=avgvalue), \n             data=hline.data, \n             linetype=6, \n             colour=\"red\", \n             size=0.5) + \n  facet_grid(~month) +\n  labs(axis.text.x = element_blank(),\n       title = \"Visitor arrivals from Vietnam by air, Jan 2010-Dec 2019\") +\n  xlab(\"\") +\n  ylab(\"No. of Visitors\")"
  },
  {
    "objectID": "In-class_Exercise/In-class_Ex03.html",
    "href": "In-class_Exercise/In-class_Ex03.html",
    "title": "In-class Exercise 3",
    "section": "",
    "text": "Installing and loading R packages\nTwo packages (tidyverse and ggiraph) are installed and loaded.\n\npacman::p_load(ggiraph, tidyverse)\n\n\n\nImporting data\n\nexam_data <- read_csv(\"data/Exam_data.csv\")\n\n\n\nPlot a dotplot (static)\n\nggplot(data=exam_data, aes(x= MATHS)) + \n      geom_dotplot(dotsize=0.5)\n\n\n\n\n\n\nPlot a dotplot (interactive)\n\np <- ggplot(data=exam_data, aes(x= MATHS)) + \n      geom_dotplot_interactive(aes(tooltip = ID),\n      stackgroups = TRUE, binwidth=1, method = \"histodot\")\ngirafe(\n  ggobj = p,\n  width_svg = 6,\n  height_svg = 6*0.618\n)"
  },
  {
    "objectID": "In-class_Exercise/In-class_Ex04.html",
    "href": "In-class_Exercise/In-class_Ex04.html",
    "title": "In-class Exercise 4",
    "section": "",
    "text": "Part 1: Statistical visualization\n\nLoading required packages\n\n\nHide the code\npacman::p_load(plotly, DT, patchwork, tidyverse, ggstatsplot)\n\n\n\n\nImporting data\n\n\nHide the code\nexam_data <- read_csv(\"data/Exam_data.csv\")\n\n\n\n\nWorking with Plot_ly() method\n\n\nHide the code\nplot_ly(data = exam_data, \n        x = ~ENGLISH, \n        y = ~MATHS, \n        color = ~RACE)\n\n\n\n\n\n\n\nChanging color with color palette\n\n\nHide the code\nplot_ly(data = exam_data, \n        x = ~ENGLISH, \n        y = ~MATHS, \n        color = ~RACE, \n        colors = \"Set1\")\n\n\n\n\n\n\n\n\nChanging to self-defined colors\n\n\nHide the code\nmy_colors <- c(\"pink\",\"skyblue\",\"lightgreen\",\"grey\")\nplot_ly(data = exam_data, \n        x = ~ENGLISH, \n        y = ~MATHS, \n        color = ~RACE, \n        colors = my_colors)\n\n\n\n\n\n\n\n\n\nWorking with ggplotly() method\n\n\nHide the code\np <- ggplot(data=exam_data, \n            aes(x = MATHS,\n                y = ENGLISH)) +\n  geom_point(dotsize = 1) +\n  coord_cartesian(xlim=c(0,100),\n                  ylim=c(0,100))\nggplotly(p)\n\n\n\n\n\n\n\n\nCoordinated Multiple Views with plotly\n\n\nHide the code\nd <- highlight_key(exam_data)  #<<\np1 <- ggplot(data=d, \n            aes(x = MATHS,\n                y = ENGLISH)) +\n  geom_point(size=1) +\n  coord_cartesian(xlim=c(0,100),\n                  ylim=c(0,100))\n\np2 <- ggplot(data=d, \n            aes(x = MATHS,\n                y = SCIENCE)) +\n  geom_point(size=1) +\n  coord_cartesian(xlim=c(0,100),\n                  ylim=c(0,100))\nsubplot(ggplotly(p1),\n        ggplotly(p2))\n\n\n\n\n\n\n\n\nWorking with ggstatsplot\n\nTwo-sample mean test: ggbetweenstats()\n\n\nHide the code\nggbetweenstats(\n  data = exam_data,\n  x = GENDER, \n  y = MATHS,\n  type = \"np\",\n  messages = FALSE\n)\n\n\n\n\n\n\n\nSignificant Test of Correlation: ggscatterstats()\n\n\nHide the code\nggscatterstats(\n  data = exam_data,\n  x = MATHS,\n  y = ENGLISH,\n  marginal = TRUE,\n  )\n\n\n\n\n\n\n\n\n\nPart 2: Visualizing models\n\nLoading packages\n\n\nHide the code\npacman::p_load(readxl, performance, parameters, see)\n\n\n\n\nImporting data\n\n\nHide the code\ncar_resale <- read_xls(\"data/ToyotaCorolla.xls\", \n                       \"data\")\ncar_resale\n\n\n# A tibble: 1,436 × 38\n      Id Model       Price Age_0…¹ Mfg_M…² Mfg_Y…³     KM Quart…⁴ Weight Guara…⁵\n   <dbl> <chr>       <dbl>   <dbl>   <dbl>   <dbl>  <dbl>   <dbl>  <dbl>   <dbl>\n 1    81 TOYOTA Cor… 18950      25       8    2002  20019     100   1180       3\n 2     1 TOYOTA Cor… 13500      23      10    2002  46986     210   1165       3\n 3     2 TOYOTA Cor… 13750      23      10    2002  72937     210   1165       3\n 4     3  TOYOTA Co… 13950      24       9    2002  41711     210   1165       3\n 5     4 TOYOTA Cor… 14950      26       7    2002  48000     210   1165       3\n 6     5 TOYOTA Cor… 13750      30       3    2002  38500     210   1170       3\n 7     6 TOYOTA Cor… 12950      32       1    2002  61000     210   1170       3\n 8     7  TOYOTA Co… 16900      27       6    2002  94612     210   1245       3\n 9     8 TOYOTA Cor… 18600      30       3    2002  75889     210   1245       3\n10    44 TOYOTA Cor… 16950      27       6    2002 110404     234   1255       3\n# … with 1,426 more rows, 28 more variables: HP_Bin <chr>, CC_bin <chr>,\n#   Doors <dbl>, Gears <dbl>, Cylinders <dbl>, Fuel_Type <chr>, Color <chr>,\n#   Met_Color <dbl>, Automatic <dbl>, Mfr_Guarantee <dbl>,\n#   BOVAG_Guarantee <dbl>, ABS <dbl>, Airbag_1 <dbl>, Airbag_2 <dbl>,\n#   Airco <dbl>, Automatic_airco <dbl>, Boardcomputer <dbl>, CD_Player <dbl>,\n#   Central_Lock <dbl>, Powered_Windows <dbl>, Power_Steering <dbl>,\n#   Radio <dbl>, Mistlamps <dbl>, Sport_Model <dbl>, Backseat_Divider <dbl>, …\n\n\n\n\nMultiple Regression Model using lm()\n\n\nHide the code\nmodel <- lm(Price ~ Age_08_04 + Mfg_Year + KM + \n              Weight + Guarantee_Period, data = car_resale)\nmodel\n\n\n\nCall:\nlm(formula = Price ~ Age_08_04 + Mfg_Year + KM + Weight + Guarantee_Period, \n    data = car_resale)\n\nCoefficients:\n     (Intercept)         Age_08_04          Mfg_Year                KM  \n      -2.637e+06        -1.409e+01         1.315e+03        -2.323e-02  \n          Weight  Guarantee_Period  \n       1.903e+01         2.770e+01  \n\n\n\n\nModel Diagnostic: checking for multicolinearity:\n\n\nHide the code\ncheck_collinearity(model)\n\n\n# Check for Multicollinearity\n\nLow Correlation\n\n             Term   VIF     VIF 95% CI Increased SE Tolerance Tolerance 95% CI\n Guarantee_Period  1.04   [1.01, 1.17]         1.02      0.97     [0.86, 0.99]\n        Age_08_04 31.07 [28.08, 34.38]         5.57      0.03     [0.03, 0.04]\n         Mfg_Year 31.16 [28.16, 34.48]         5.58      0.03     [0.03, 0.04]\n\nHigh Correlation\n\n   Term  VIF   VIF 95% CI Increased SE Tolerance Tolerance 95% CI\n     KM 1.46 [1.37, 1.57]         1.21      0.68     [0.64, 0.73]\n Weight 1.41 [1.32, 1.51]         1.19      0.71     [0.66, 0.76]\n\n\n\n\nVisualize multicollinearity\nVIF, log scaled of more than 10 = multicollinearity that needs to be addressed.\n\n\nHide the code\ncheck_c <- check_collinearity(model)\nplot(check_c)\n\n\n\n\n\n\n\nRemove “Mfg_Year” from model due to collinearity\n\n\nHide the code\nmodel1 <- lm(Price ~ Age_08_04 + Weight + KM\n             + Guarantee_Period, data = car_resale)\n\n\n\n\nCheck normality assumption\n\n\nHide the code\ncheck_n <- check_normality(model1)\n\n\n\n\nHide the code\nplot(check_n)\n\n\n\n\n\n\n\nCheck heteroscedasticity\n\n\nHide the code\ncheck_h <- check_heteroscedasticity(model1)\n\n\n\n\nHide the code\nplot(check_h)\n\n\n\n\n\n\n\nComplete check\n\n\nHide the code\ncheck_model(model1)\n\n\n\n\n\n\n\nVisualising Regression Parameters: see methods\n\n\nHide the code\nplot(parameters(model1))\n\n\n\n\n\n\n\nVisualising Regression Parameters: ggcoefstats() methods\n\n\nHide the code\nggcoefstats(model1, \n            output = \"plot\")\n\n\n\n\n\n\n\n\nPart 3: Visualising uncertainty (Standard errors)\n\n\nHide the code\npacman::p_load(crosstalk, DT, ggdist, gganimate)\n\n\n\n\nHide the code\nmy_sum <- exam_data %>%\n  group_by(RACE) %>%\n  summarise(\n    n=n(),\n    mean=mean(MATHS),\n    sd=sd(MATHS)\n    ) %>%\n  mutate(se=sd/sqrt(n-1))\n\n\n\n\nHide the code\nknitr::kable(head(my_sum), format = 'html')\n\n\n\n\n \n  \n    RACE \n    n \n    mean \n    sd \n    se \n  \n \n\n  \n    Chinese \n    193 \n    76.50777 \n    15.69040 \n    1.132357 \n  \n  \n    Indian \n    12 \n    60.66667 \n    23.35237 \n    7.041005 \n  \n  \n    Malay \n    108 \n    57.44444 \n    21.13478 \n    2.043177 \n  \n  \n    Others \n    9 \n    69.66667 \n    10.72381 \n    3.791438 \n  \n\n\n\n\n\n\n\nHide the code\nggplot(my_sum) +\n  geom_errorbar(\n    aes(x=RACE, \n        ymin=mean-se, \n        ymax=mean+se), \n    width=0.2, \n    colour=\"black\", \n    alpha=0.9, \n    size=0.5) +\n  geom_point(aes\n           (x=RACE, \n            y=mean), \n           stat=\"identity\", \n           color=\"red\",\n           size = 1.8,\n           alpha=1) +\n  ggtitle(\"Standard error of mean \n          maths score by race\")"
  },
  {
    "objectID": "In-class_Exercise/In-class_Ex05.html",
    "href": "In-class_Exercise/In-class_Ex05.html",
    "title": "In Class Exercise 5",
    "section": "",
    "text": "Hide the code\npacman::p_load(corrplot, tidyverse, ggstatsplot)\n\n\n\n\n\n\n\nHide the code\nwine <- read_csv(\"data/wine_quality.csv\")\n\n\n\n\n\n\n\nHide the code\npairs(wine[,1:11])\n\n\n\n\n\n\n\n\n\n\nHide the code\npairs(wine[,1:11], upper.panel = NULL)\n\n\n\n\n\n\n\n\n\n\nHide the code\n#|fig-width = 15\n#|fig-height = 15\nggstatsplot::ggcorrmat(\n  data = wine, \n  cor.vars = 1:11,\n  sig.level = 0.05,\n  ggcorrplot.args = list(outline.color = \"black\", \n                         hc.order = TRUE,\n                         tl.cex = 8),\n  title    = \"Correlogram for wine dataset\",\n  subtitle = \"Four pairs are not significant at p < 0.05\"\n)\n\n\n\n\n\n\n\n\ncorrplot has more features as compared to ggcorrmat - geometry object and ordering method. A correlation matrix needs to be calculated first before corrplot can be ploted.\n\n\nHide the code\nwine.cor <- cor(wine[, 1:11])\n\n\n\n\nHide the code\ncorrplot(wine.cor, \n         method = \"ellipse\", \n         type=\"lower\",\n         diag = FALSE,\n         tl.col = \"black\")\n\n\n\n\n\nWe can choose to reorder the correlation matrix using hclust (grouping the similar variables together)\n\n\nHide the code\ncorrplot(wine.cor, \n         method = \"ellipse\", \n         tl.pos = \"lt\",\n         tl.col = \"black\",\n         order=\"hclust\",\n         hclust.method = \"ward.D\",\n         addrect = 3)"
  },
  {
    "objectID": "In-class_Exercise/In-class_Ex05.html#use-ternary-plot-to-visualize-3-dimensions",
    "href": "In-class_Exercise/In-class_Ex05.html#use-ternary-plot-to-visualize-3-dimensions",
    "title": "In Class Exercise 5",
    "section": "Use ternary plot to visualize 3 dimensions",
    "text": "Use ternary plot to visualize 3 dimensions\n\n\nHide the code\npacman::p_load(ggtern, plotly)\n\n\n\n\nHide the code\npop_data <- read_csv(\"data/respopagsex2000to2018_tidy.csv\") \n\n\n\nImport the data\n\n\nHide the code\nagpop_mutated <- pop_data %>%\n  mutate(`Year` = as.character(Year))%>%\n  spread(AG, Population) %>%\n  mutate(YOUNG = rowSums(.[4:8]))%>%\n  mutate(ACTIVE = rowSums(.[9:16]))  %>%\n  mutate(OLD = rowSums(.[17:21])) %>%\n  mutate(TOTAL = rowSums(.[22:24])) %>%\n  filter(Year == 2018)%>%\n  filter(TOTAL > 0)\n\n\n\n\nHide the code\nggtern(data=agpop_mutated, aes(x=YOUNG,y=ACTIVE, z=OLD)) +\n  geom_point() +\n  labs(title=\"Population structure, 2018\") +\n  theme_rgbw()\n\n\n\n\n\n\n\nPlot interactive ternary diagram\n\n\nHide the code\nlabel <- function(txt) {\n  list(\n    text = txt, \n    x = 0.1, y = 1,\n    ax = 0, ay = 0,\n    xref = \"paper\", yref = \"paper\", \n    align = \"center\",\n    font = list(family = \"serif\", size = 15, color = \"white\"),\n    bgcolor = \"#b3b3b3\", bordercolor = \"black\", borderwidth = 2\n  )\n}\n\naxis <- function(txt) {\n  list(\n    title = txt, tickformat = \".0%\", tickfont = list(size = 10)\n  )\n}\n\nternaryAxes <- list(\n  aaxis = axis(\"Young\"), \n  baxis = axis(\"Active\"), \n  caxis = axis(\"Old\")\n)\n\nplot_ly(\n  agpop_mutated, \n  a = ~YOUNG, \n  b = ~ACTIVE, \n  c = ~OLD, \n  color = I(\"black\"), \n  type = \"scatterternary\"\n) %>%\n  layout(\n    annotations = label(\"Ternary Markers\"), \n    ternary = ternaryAxes\n  )"
  },
  {
    "objectID": "In-class_Exercise/In-class_Ex05.html#plot-heatmap",
    "href": "In-class_Exercise/In-class_Ex05.html#plot-heatmap",
    "title": "In Class Exercise 5",
    "section": "Plot heatmap",
    "text": "Plot heatmap\n\n\nHide the code\npacman::p_load(seriation, dendextend, heatmaply)\n\n\n\n\nHide the code\nwh <- read_csv(\"data/WHData-2018.csv\")\n\n\n\nTransform the data frame\nMake “country” the row name (index) so that country will be used as label in heatmap\n\n\nHide the code\nrow.names(wh) <- wh$Country\n\n\nTransform the dataframe into a matrix (take columns number 4 and 7-12)\n\n\nHide the code\nwh1 <- dplyr::select(wh, c(3, 7:12))\nwh_matrix <- data.matrix(wh)\n\n\n\n\nCreate heatmap using heatmaply\n-c means excluding the columns\n\n\nHide the code\nheatmaply(normalize(wh_matrix[, -c(1, 2, 4, 5)]),\n          Colv=NA,\n          seriate = \"none\",\n          colors = Blues,\n          k_row = 5,\n          margins = c(NA,200,60,NA),\n          fontsize_row = 5,\n          fontsize_col = 5,\n          main=\"World Happiness Score and Variables by Country, 2018 \\nDataTransformation using Normalise Method\",\n          xlab = \"World Happiness Indicators\",\n          ylab = \"World Countries\"\n          )"
  },
  {
    "objectID": "In-class_Exercise/In-class_Ex06.html",
    "href": "In-class_Exercise/In-class_Ex06.html",
    "title": "In Class Exercise 6",
    "section": "",
    "text": "In this take home exercise, we will learn ways to visualize time series data in Tableau."
  },
  {
    "objectID": "In-class_Exercise/In-class_Ex06.html#i.-dataset-used",
    "href": "In-class_Exercise/In-class_Ex06.html#i.-dataset-used",
    "title": "In Class Exercise 6",
    "section": "i. Dataset used",
    "text": "i. Dataset used\n“Arrival by Air” can be obtained from Singapore Tourism Board."
  },
  {
    "objectID": "In-class_Exercise/In-class_Ex06.html#ii.-pivot-longer",
    "href": "In-class_Exercise/In-class_Ex06.html#ii.-pivot-longer",
    "title": "In Class Exercise 6",
    "section": "ii. Pivot (longer)",
    "text": "ii. Pivot (longer)\nThe original dataset is organized with each country as a column, which is not very useful when building visualization. Hence, we pivot the table to convert the country columns into rows."
  },
  {
    "objectID": "In-class_Exercise/In-class_Ex06.html#iii.-building-a-simple-line-chart-by-country",
    "href": "In-class_Exercise/In-class_Ex06.html#iii.-building-a-simple-line-chart-by-country",
    "title": "In Class Exercise 6",
    "section": "iiI. Building a simple line chart by country",
    "text": "iiI. Building a simple line chart by country\nWe can easily create a line chart in Tableau with country and date as filters to show time-series pattern."
  },
  {
    "objectID": "In-class_Exercise/In-class_Ex06.html#iv.-visualising-cyclical-patterns-using-cycle-plot",
    "href": "In-class_Exercise/In-class_Ex06.html#iv.-visualising-cyclical-patterns-using-cycle-plot",
    "title": "In Class Exercise 6",
    "section": "iV. Visualising cyclical patterns using cycle plot",
    "text": "iV. Visualising cyclical patterns using cycle plot\nThe purpose of this is for viewers to visualise the trend more easily.\n\nFrom the line chart on the left, we can clearly see that tourist number from Italy is the highest in the month of August. And from the cycle plot, we see that for the month of August, the number of tourists from Italy increases sharply over years.\nThe interactive dashboard can be found on Tableau"
  },
  {
    "objectID": "In-class_Exercise/In-class_Ex06.html#i.-dataset-used-1",
    "href": "In-class_Exercise/In-class_Ex06.html#i.-dataset-used-1",
    "title": "In Class Exercise 6",
    "section": "i. Dataset used",
    "text": "i. Dataset used\n“eventlog.csv” can be obtained from Github"
  },
  {
    "objectID": "In-class_Exercise/In-class_Ex06.html#ii.-plotting-a-calendar-heatmap",
    "href": "In-class_Exercise/In-class_Ex06.html#ii.-plotting-a-calendar-heatmap",
    "title": "In Class Exercise 6",
    "section": "ii. Plotting a calendar heatmap",
    "text": "ii. Plotting a calendar heatmap\n\nFrom the heatmap, we can clearly see that the boxes are darker in color for certain dates, which represents more events on those dates.\nThe interactive dashboard can be found on Tableau"
  },
  {
    "objectID": "In-class_Exercise/In-class_Ex06.html#i.-dataset-used-2",
    "href": "In-class_Exercise/In-class_Ex06.html#i.-dataset-used-2",
    "title": "In Class Exercise 6",
    "section": "i. Dataset used",
    "text": "i. Dataset used\n“rice.csv” can be obtained from Github"
  },
  {
    "objectID": "In-class_Exercise/In-class_Ex06.html#ii.-plotting-a-slopegraph",
    "href": "In-class_Exercise/In-class_Ex06.html#ii.-plotting-a-slopegraph",
    "title": "In Class Exercise 6",
    "section": "ii. Plotting a slopegraph",
    "text": "ii. Plotting a slopegraph\n\nThe interactive dashboard can be found on Tableau"
  },
  {
    "objectID": "In-class_Exercise/In-class_Ex06.html#i.-dataset-used-3",
    "href": "In-class_Exercise/In-class_Ex06.html#i.-dataset-used-3",
    "title": "In Class Exercise 6",
    "section": "i. Dataset used",
    "text": "i. Dataset used\n“GlobalPopulation.xls” can be obtained from Github"
  },
  {
    "objectID": "In-class_Exercise/In-class_Ex06.html#ii.-plotting-a-bubbleplot",
    "href": "In-class_Exercise/In-class_Ex06.html#ii.-plotting-a-bubbleplot",
    "title": "In Class Exercise 6",
    "section": "ii. Plotting a bubbleplot",
    "text": "ii. Plotting a bubbleplot\n\nThis chart is animated to showcase the changes of young and old population over years. Viewers can also select a country (represented by one bubble) to see the history train of how the demographic has changed over years.\nThe interactive dashboard can be found on Tableau"
  },
  {
    "objectID": "In-class_Exercise/In-class_Ex07.html",
    "href": "In-class_Exercise/In-class_Ex07.html",
    "title": "In Class Exercise 7",
    "section": "",
    "text": "The dataset used is “SGPools.xls” and it can be retrieved from Github.\nIt is rather easy to create a symbol map with Tableau.\nFirst, we created a point symbol map, with branch and outlet segregated with the different colors.\n\n\n\n\n\n\nWe also created Proportional Symbol Map with the number of winnings represented by the bubble size.\n\n\n\nUsing another set of data - ResidentialTransaction to plot proportional symbol map.\n\n\n\n\n\n\nUsing the Singapore Pool data again, we create the Proportional Symbol Map with R.\n\n\nShow the code\n# Import the required packages\npacman::p_load(sf, tmap, tidyverse)\n\n# import the data into R\nsgpools <- read_csv(\"data/aspatial/SGPools_svy21.csv\")\n\n# converts sgpools data frame into a simple feature data frame \nsgpools_sf <- st_as_sf(sgpools, \n                       coords = c(\"XCOORD\", \"YCOORD\"),\n                       crs= 3414)\n\ntmap_mode(\"view\")\n# plot the map\ntm_shape(sgpools_sf)+\ntm_bubbles(col = \"OUTLET TYPE\", \n          size = \"Gp1Gp2 Winnings\",\n          border.col = \"black\",\n          border.lwd = 1)\n\n\n\n\n\n\n\ntmap allows us to do a facet plot with coordinated view.\n\n\nShow the code\n# Syncing 2 plots\ntm_shape(sgpools_sf) +\n  tm_bubbles(col = \"OUTLET TYPE\", \n          size = \"Gp1Gp2 Winnings\",\n          border.col = \"black\",\n          border.lwd = 1) +\n  tm_facets(by= \"OUTLET TYPE\",\n            nrow = 1,\n            sync = TRUE)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nShow the code\ntmap_mode(\"plot\")"
  },
  {
    "objectID": "In-class_Exercise/In-class_Ex07.html#choropleth-map-with-tableau",
    "href": "In-class_Exercise/In-class_Ex07.html#choropleth-map-with-tableau",
    "title": "In Class Exercise 7",
    "section": "Choropleth Map with Tableau",
    "text": "Choropleth Map with Tableau\nNext, we plot a choropleth mal with Tableau with Singapore population data (respopagesextod2022.csv).\nAll the Tableau visualizations can be viewed here."
  },
  {
    "objectID": "In-class_Exercise/In-class_Ex07.html#choropleth-map-with-r",
    "href": "In-class_Exercise/In-class_Ex07.html#choropleth-map-with-r",
    "title": "In Class Exercise 7",
    "section": "Choropleth Map with R",
    "text": "Choropleth Map with R\nIn the following code, we perform the required data wrangling and plot the choropleth map.\nThe data and shapefile used can be retrieved from Github.\nWe use tmap as it already provides all the function required to plot a nice choropleth map.\n\n\nShow the code\n# Import the required packages\npacman::p_load(sf, tmap, tidyverse)\n\n# Import shapefile into R\nmpsz <- st_read(dsn = \"data/geospatial\", \n                layer = \"MP14_SUBZONE_WEB_PL\")\n\n\nReading layer `MP14_SUBZONE_WEB_PL' from data source \n  `D:\\shiangrou\\ISSS608-VAA\\In-class_Exercise\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 323 features and 15 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 2667.538 ymin: 15748.72 xmax: 56396.44 ymax: 50256.33\nProjected CRS: SVY21\n\n\nShow the code\n# Import data into R\npopdata <- read_csv(\"data/aspatial/respopagesextod2011to2020.csv\")\n\n# Data wrangling\npopdata2020 <- popdata %>%\n  filter(Time == 2020) %>%\n  group_by(PA, SZ, AG) %>%\n  summarise(`POP` = sum(`Pop`)) %>%\n  ungroup()%>%\n  pivot_wider(names_from=AG, \n              values_from=POP) %>%\n  mutate(YOUNG = rowSums(.[3:6])\n         +rowSums(.[12])) %>%\nmutate(`ECONOMY ACTIVE` = rowSums(.[7:11])+\nrowSums(.[13:15]))%>%\nmutate(`AGED`=rowSums(.[16:21])) %>%\nmutate(`TOTAL`=rowSums(.[3:21])) %>%  \nmutate(`DEPENDENCY` = (`YOUNG` + `AGED`)\n/`ECONOMY ACTIVE`) %>%\n  select(`PA`, `SZ`, `YOUNG`, \n       `ECONOMY ACTIVE`, `AGED`, \n       `TOTAL`, `DEPENDENCY`)\n\n# Convert PA and SZ to uppercase\npopdata2020 <- popdata2020 %>%\n  mutate_at(.vars = vars(PA, SZ), \n          .funs = funs(toupper)) %>%\n  filter(`ECONOMY ACTIVE` > 0)\n\n# join the data to mpsz\nmpsz_pop2020 <- left_join(mpsz, popdata2020,\n                          by = c(\"SUBZONE_N\" = \"SZ\"))\n\nwrite_rds(mpsz_pop2020, \"data/rds/mpszpop2020.rds\")\n\n# plotting a choropleth map\ntm_shape(mpsz_pop2020)+\n  tm_fill(\"DEPENDENCY\", \n          style = \"quantile\", \n          palette = \"Blues\",\n          title = \"Dependency ratio\") +\n  tm_layout(main.title = \"Distribution of Dependency Ratio by planning subzone\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            legend.height = 0.45, \n            legend.width = 0.35,\n            frame = TRUE) +\n  tm_borders(alpha = 0.5) +\n  tm_compass(type=\"8star\", size = 2) +\n  tm_scale_bar() +\n  tm_grid(alpha =0.2) +\n  tm_credits(\"Source: Planning Sub-zone boundary from Urban Redevelopment Authorithy (URA)\\n and Population data from Department of Statistics DOS\", \n             position = c(\"left\", \"bottom\"))"
  },
  {
    "objectID": "In-class_Exercise/In-class_Ex08.html#packages",
    "href": "In-class_Exercise/In-class_Ex08.html#packages",
    "title": "In Class Exercise 8",
    "section": "1. Packages",
    "text": "1. Packages\nNetwork Analysis 1. igraph: Network Analysis and Visualization. There is also R CRAN version of documentation. 2. tidygraph: A Tidy API for Graph Manipulation.\nNetwork Visualization 1. ggraph 2. vizNetwork"
  },
  {
    "objectID": "In-class_Exercise/In-class_Ex08.html#load-packages-and-data",
    "href": "In-class_Exercise/In-class_Ex08.html#load-packages-and-data",
    "title": "In Class Exercise 8",
    "section": "2. Load packages and data",
    "text": "2. Load packages and data\n\n\nShow the code\npacman::p_load(igraph, tidygraph, ggraph, \n               visNetwork, lubridate, clock,\n               tidyverse, graphlayouts)\n\n\n\n\nShow the code\nGAStech_nodes <- read_csv(\"data/GAStech_email_node.csv\")\nGAStech_edges <- read_csv(\"data/GAStech_email_edge-v2.csv\")\nglimpse(GAStech_edges)\n\n\nRows: 9,063\nColumns: 8\n$ source      <dbl> 43, 43, 44, 44, 44, 44, 44, 44, 44, 44, 44, 44, 26, 26, 26…\n$ target      <dbl> 41, 40, 51, 52, 53, 45, 44, 46, 48, 49, 47, 54, 27, 28, 29…\n$ SentDate    <chr> \"6/1/2014\", \"6/1/2014\", \"6/1/2014\", \"6/1/2014\", \"6/1/2014\"…\n$ SentTime    <time> 08:39:00, 08:39:00, 08:58:00, 08:58:00, 08:58:00, 08:58:0…\n$ Subject     <chr> \"GT-SeismicProcessorPro Bug Report\", \"GT-SeismicProcessorP…\n$ MainSubject <chr> \"Work related\", \"Work related\", \"Work related\", \"Work rela…\n$ sourceLabel <chr> \"Sven.Flecha\", \"Sven.Flecha\", \"Kanon.Herrero\", \"Kanon.Herr…\n$ targetLabel <chr> \"Isak.Baza\", \"Lucas.Alcazar\", \"Felix.Resumir\", \"Hideki.Coc…"
  },
  {
    "objectID": "In-class_Exercise/In-class_Ex08.html#data-wrangling",
    "href": "In-class_Exercise/In-class_Ex08.html#data-wrangling",
    "title": "In Class Exercise 8",
    "section": "3. Data Wrangling",
    "text": "3. Data Wrangling\n\n\nShow the code\n# change to date format\nGAStech_edges <- GAStech_edges %>%\n  mutate(SendDate = dmy(SentDate)) %>%\n  mutate(Weekday = wday(SentDate,\n                        label = TRUE,\n                        abbr = FALSE))\n\n# Aggregate the records and create weight\nGAStech_edges_aggregated <- GAStech_edges %>%\n  filter(MainSubject == \"Work related\") %>%\n  group_by(source, target, Weekday) %>%\n    summarise(Weight = n()) %>%\n  filter(source!=target) %>%\n  filter(Weight > 1) %>%\n  ungroup()"
  },
  {
    "objectID": "In-class_Exercise/In-class_Ex08.html#using-tbl_graph-to-build-tidygraph-data-model",
    "href": "In-class_Exercise/In-class_Ex08.html#using-tbl_graph-to-build-tidygraph-data-model",
    "title": "In Class Exercise 8",
    "section": "4. Using tbl_graph() to build tidygraph data model",
    "text": "4. Using tbl_graph() to build tidygraph data model\n\n\nShow the code\nGAStech_graph <- tbl_graph(nodes = GAStech_nodes,\n                           edges = GAStech_edges_aggregated, \n                           directed = TRUE)\n\nGAStech_graph %>%\n  activate(edges) %>%\n  arrange(desc(Weight))\n\n\n# A tbl_graph: 54 nodes and 1372 edges\n#\n# A directed multigraph with 1 component\n#\n# Edge Data: 1,372 × 4 (active)\n   from    to Weekday  Weight\n  <int> <int> <ord>     <int>\n1    40    41 Saturday     13\n2    41    43 Monday       11\n3    35    31 Tuesday      10\n4    40    41 Monday       10\n5    40    43 Monday       10\n6    36    32 Sunday        9\n# … with 1,366 more rows\n#\n# Node Data: 54 × 4\n     id label           Department     Title           \n  <dbl> <chr>           <chr>          <chr>           \n1     1 Mat.Bramar      Administration Assistant to CEO\n2     2 Anda.Ribera     Administration Assistant to CFO\n3     3 Rachel.Pantanal Administration Assistant to CIO\n# … with 51 more rows\n\n\nShow the code\nggraph(GAStech_graph) +\n  geom_edge_link() +\n  geom_node_point()"
  },
  {
    "objectID": "In-class_Exercise/In-class_Ex08.html#changing-the-appearance-of-the-graph",
    "href": "In-class_Exercise/In-class_Ex08.html#changing-the-appearance-of-the-graph",
    "title": "In Class Exercise 8",
    "section": "5. Changing the appearance of the graph",
    "text": "5. Changing the appearance of the graph\n\n\nShow the code\ng <- ggraph(GAStech_graph, layout=\"nicely\") + \n  geom_edge_link(aes(),colour = 'grey60', size=0.4) +\n  geom_node_point(aes(), colour = 'red',size=2.2) \n\ng + theme_graph()"
  },
  {
    "objectID": "In-class_Exercise/In-class_Ex08.html#changing-the-layout-of-the-graph",
    "href": "In-class_Exercise/In-class_Ex08.html#changing-the-layout-of-the-graph",
    "title": "In Class Exercise 8",
    "section": "6. Changing the layout of the graph",
    "text": "6. Changing the layout of the graph\n\n\nShow the code\n# Fruchterman and Reingold layout\ng <- ggraph(GAStech_graph, \n            layout = \"fr\") +\n  geom_edge_link(aes()) +\n  geom_node_point(aes())\n\ng + theme_graph()\n\n\n\n\n\n\n\nShow the code\n# Circle layout\ng <- ggraph(GAStech_graph, \n            layout = \"circle\") +\n  geom_edge_link(aes()) +\n  geom_node_point(aes())\n\ng + theme_graph()"
  },
  {
    "objectID": "In-class_Exercise/In-class_Ex08.html#creating-facet-graphs",
    "href": "In-class_Exercise/In-class_Ex08.html#creating-facet-graphs",
    "title": "In Class Exercise 8",
    "section": "7. Creating facet graphs",
    "text": "7. Creating facet graphs\n\n\nShow the code\nset_graph_style()\n\ng <- ggraph(GAStech_graph, \n            layout = \"nicely\") + \n  geom_edge_link(aes(width=Weight), \n                 alpha=0.2) +\n  scale_edge_width(range = c(0.1, 5)) +\n  geom_node_point(aes(colour = Department), \n                  size = 2) +\n  theme(legend.position = 'bottom')\n\ng + facet_edges(~Weekday) +\n  th_foreground(foreground = \"grey80\",  \n                border = TRUE) +\n  theme(legend.position = 'bottom')"
  },
  {
    "objectID": "In-class_Exercise/In-class_Ex08.html#building-interactive-network-graph-with-visnetwork",
    "href": "In-class_Exercise/In-class_Ex08.html#building-interactive-network-graph-with-visnetwork",
    "title": "In Class Exercise 8",
    "section": "Building Interactive Network Graph with visNetwork",
    "text": "Building Interactive Network Graph with visNetwork\n\n\nShow the code\nGAStech_edges_aggregated <- GAStech_edges %>%\n  left_join(GAStech_nodes, by = c(\"sourceLabel\" = \"label\")) %>%\n  rename(from = id) %>%\n  left_join(GAStech_nodes, by = c(\"targetLabel\" = \"label\")) %>%\n  rename(to = id) %>%\n  filter(MainSubject == \"Work related\") %>%\n  group_by(from, to) %>%\n    summarise(weight = n()) %>%\n  filter(from!=to) %>%\n  filter(weight > 1) %>%\n  ungroup()\n\nvisNetwork(GAStech_nodes, \n           GAStech_edges_aggregated)\n\n\n\n\n\n\nShow the code\nvisNetwork(GAStech_nodes,\n           GAStech_edges_aggregated) %>%\n  visIgraphLayout(layout = \"layout_with_fr\")"
  },
  {
    "objectID": "In-class_Exercise/In-class_Ex08.html#changing-the-visual-attributes",
    "href": "In-class_Exercise/In-class_Ex08.html#changing-the-visual-attributes",
    "title": "In Class Exercise 8",
    "section": "Changing the visual attributes",
    "text": "Changing the visual attributes\n\n\nShow the code\nGAStech_nodes <- GAStech_nodes %>%\n  rename(group = Department) \n\nvisNetwork(GAStech_nodes,\n           GAStech_edges_aggregated) %>%\n  visIgraphLayout(layout = \"layout_with_fr\") %>%\n  visLegend() %>%\n  visLayout(randomSeed = 123)"
  },
  {
    "objectID": "In-class_Exercise/In-class_Ex08.html#adding-interactivity",
    "href": "In-class_Exercise/In-class_Ex08.html#adding-interactivity",
    "title": "In Class Exercise 8",
    "section": "Adding Interactivity",
    "text": "Adding Interactivity\n\n\nShow the code\nvisNetwork(GAStech_nodes,\n           GAStech_edges_aggregated) %>%\n  visIgraphLayout(layout = \"layout_with_fr\") %>%\n  visOptions(highlightNearest = TRUE,\n             nodesIdSelection = TRUE) %>%\n  visLegend() %>%\n  visLayout(randomSeed = 123)"
  },
  {
    "objectID": "In-class_Exercise/In-class_Ex09.html",
    "href": "In-class_Exercise/In-class_Ex09.html",
    "title": "In Class Exercise 9",
    "section": "",
    "text": "In this exercise, we are using Tableau to build information dashboard. Coffee Chain.mdb dataset is used for the purpose of this exercise."
  },
  {
    "objectID": "In-class_Exercise/In-class_Ex09.html#bullet-graph",
    "href": "In-class_Exercise/In-class_Ex09.html#bullet-graph",
    "title": "In Class Exercise 9",
    "section": "2. Bullet Graph",
    "text": "2. Bullet Graph\nBuilding a bullet graph in Tableau is pretty easy, just click on “Show Me” and select the bullet graph."
  },
  {
    "objectID": "In-class_Exercise/In-class_Ex09.html#sparkline",
    "href": "In-class_Exercise/In-class_Ex09.html#sparkline",
    "title": "In Class Exercise 9",
    "section": "3. Sparkline",
    "text": "3. Sparkline\nCreating a sparkline in Tableau with max and min point"
  },
  {
    "objectID": "In-class_Exercise/In-class_Ex09.html#dashboard",
    "href": "In-class_Exercise/In-class_Ex09.html#dashboard",
    "title": "In Class Exercise 9",
    "section": "4. Dashboard",
    "text": "4. Dashboard\nCombining the 2 graphs to create a dashboard"
  },
  {
    "objectID": "In-class_Exercise/In-class_Ex10.html",
    "href": "In-class_Exercise/In-class_Ex10.html",
    "title": "In Class Exercise 10",
    "section": "",
    "text": "In this exercise, the dataset “SGBank.csv” is used. In Tableau, candlestick chart is not readily available, but we can still have it created with some calculated fields manually created."
  },
  {
    "objectID": "In-class_Exercise/In-class_Ex10.html#bollinger-band",
    "href": "In-class_Exercise/In-class_Ex10.html#bollinger-band",
    "title": "In Class Exercise 10",
    "section": "2. Bollinger Band",
    "text": "2. Bollinger Band\nA bollinger band with moving average, upper and lower bound can also be built."
  },
  {
    "objectID": "In-class_Exercise/In-class_Ex10.html#using-r-to-visualize-financial-data",
    "href": "In-class_Exercise/In-class_Ex10.html#using-r-to-visualize-financial-data",
    "title": "In Class Exercise 10",
    "section": "3. Using R to visualize financial data",
    "text": "3. Using R to visualize financial data\n\nLoad the packages\n\n\nShow the code\npacman::p_load(lubridate, tidyquant, ggHoriPlot,\n               timetk, ggthemes, plotly, tidyverse)\n\n\n\n\nImport the data\n\n\nShow the code\ncompany <- read_csv(\"data/companySG.csv\")\nTop40 <- company %>% \n  slice_max(`marketcap`, n=40) %>% \n  select(symbol)\n\n\n\n\nExtract values from Yahoo Finance\n\n\nShow the code\nStock40_daily <- Top40 %>%\n  tq_get(get = \"stock.prices\", \n         from = \"2020-01-01\", \n         to = \"2022-03-31\") %>%\n  group_by(symbol) %>%\n  tq_transmute(select = NULL, \n               mutate_fun = to.period, \n               period  = \"days\")\n\n\n\n\nPlot horizon graph\n\n\nShow the code\nStock40_daily <- Stock40_daily %>%\n  left_join(company) %>%\n  select(1:8, 11:12)\n\n\n\n\nShow the code\nStock40_daily %>% \n  ggplot() +\n  geom_horizon(aes(x = date, y=adjusted), origin = \"midpoint\", horizonscale = 6)+\n  facet_grid(Name~.)+ #<<\n  geom_vline(xintercept = as.Date(\"2020-03-11\"), colour = \"grey15\", linetype = \"dashed\", size = 0.5)+ #<<\n  geom_vline(xintercept = as.Date(\"2020-12-14\"), colour = \"grey15\", linetype = \"dashed\", size = 0.5)+ #<<\n  theme_few() +\n  scale_fill_hcl(palette = 'RdBu') +\n  theme(panel.spacing.y=unit(0, \"lines\"),\n        strip.text.y = element_text(size = 5, angle = 0, hjust = 0),\n    legend.position = 'none',\n    axis.text.y = element_blank(),\n    axis.text.x = element_text(size=7),\n    axis.title.y = element_blank(),\n    axis.title.x = element_blank(),\n    axis.ticks.y = element_blank(),\n    panel.border = element_blank()\n    ) +\n  scale_x_date(expand=c(0,0), date_breaks = \"1 month\", date_labels = \"%b%y\") +\n  ggtitle('Daily Adjusted Prices (Jan 2020 to Mar 2022)') \n\n\n\n\n\n\n\nPlot line graph\n\n\nShow the code\nStock40_daily %>%\n  filter(symbol == \"DBSDF\") %>%\n  ggplot(aes(x = date, y = close)) +\n    geom_line() +\n    labs(title = \"DBS Group Holdings Ltd (DBSDF) Daily Stock Price\", \n         y = \"Closing Price\", x = \"\") + \n    theme_tq()\n\n\n\n\n\n\n\nPlot interactive line graph\n\n\nShow the code\nselected_stocks <-  Stock40_daily %>%\n  filter (`symbol` == c(\"C09.SI\", \"SINGF\", \"SNGNF\", \"C52.SI\"))\n\np <- ggplot(selected_stocks, \n            aes(x = date, y = adjusted)) + \n  scale_y_continuous() +\n  geom_line() +\n  facet_wrap(~Name, scales = \"free_y\",) +\n  theme_tq() +\n  labs(title = \"Daily stock prices of selected weak stocks\", \n       x = \"\", y = \"Adjusted Price\") + \n  theme(axis.text.x = element_text(size = 6), \n        axis.text.y = element_text(size = 6))\n\nggplotly(p)\n\n\n\n\n\n\n\n\nPlot candlestick chart with R\n\n\nShow the code\nend <- as_date(\"2022-03-31\")\nStock40_daily %>%\n  filter(symbol == \"DBSDF\") %>%\n  ggplot(aes(\n    x = date, y = close)) +\n  geom_candlestick(aes(\n    open = open, high = high, \n    low = low, close = close)) +\n  geom_line(size = 0.5)+\n  geom_ma(color = \"darkgreen\", n = 20) +\n  geom_ma(color = \"lightgreen\", n = 5) + \n    coord_x_date(xlim = c(end - weeks(12), \n                          end),\n                 ylim = c(20, 35),\n                 expand = TRUE) +\n  labs(title = \"DBS Group Holdings Ltd (DBSDF) Daily Stock Price\",\n       subtitle = \"darkgreen = 1-day MA, lightgreen = 5-day MA\",\n       y = \"Closing Price\", x = \"\") + \n  theme_tq()\n\n\n\n\n\n\n\nPlot Bollinger Band with R\n\n\nShow the code\nStock40_daily %>%\n  filter(symbol == \"DBSDF\") %>% \n  ggplot(aes(x=date, y=close))+\n  geom_line(size=0.5)+\n  geom_bbands(aes(\n    high = high, low = low, close = close), \n    ma_fun = SMA, sd = 2, n = 20,\n    size = 0.75, color_ma = \"royalblue4\", \n    color_bands = \"red1\")+\n    coord_x_date(xlim = c(\"2020-02-01\", \n                          \"2022-03-31\"), \n                 expand = TRUE)+\n    labs(title = \"DBS Group Holdings Ltd (DBSDF) Daily Stock Price\",\n         subtitle = \"dotted red lines = bollinger bands\",\n         x = \"Date\", y =\"Price\") +\ntheme(legend.position=\"none\")\n\n\n\n\n\n\n\nPlot interactive candlestick chart\n\n\nShow the code\ncandleStick_plot<-function(symbol, from, to){\n  tq_get(symbol, from = from, to = to, warnings = FALSE) %>% \n    mutate(greenRed=ifelse(open-close>0, \"Red\", \"Green\")) %>% \n    ggplot()+\n    geom_segment(\n      aes(x = date, xend=date, y =open, yend =close, colour=greenRed), \n      size=3)+\n    theme_tq()+\n    geom_segment(\n      aes(x = date, xend=date, y =high, yend =low, colour=greenRed))+\n    scale_color_manual(values=c(\"ForestGreen\",\"Red\"))+\n    ggtitle(paste0(symbol,\" (\",from,\" - \",to,\")\"))+\n    theme(legend.position =\"none\",\n          axis.title.y = element_blank(),\n          axis.title.x=element_blank(),\n          axis.text.x = element_text(angle = 0, vjust = 0.5, hjust=1),\n          plot.title= element_text(hjust=0.5))\n}\n\np <- candleStick_plot(\"DBSDF\",\n                      from = '2022-01-01',\n                      to = today())\nggplotly(p)"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Visual Analytics & Application",
    "section": "",
    "text": "Welcome to my site!\nHello, I am Shiang Rou.\nThis site contains all the individual assignments and work done for ISSS608 Visual Analytics module in SMU Master of IT in Business."
  },
  {
    "objectID": "Take_Home_Exercise/Take_Home_Exercise_1/Take_Home_Exercise_1.html",
    "href": "Take_Home_Exercise/Take_Home_Exercise_1/Take_Home_Exercise_1.html",
    "title": "Take Home Exercise 1",
    "section": "",
    "text": "In this take-home exercise, we will explore using age-sex pyramids to showcase the age and gender composition of Singapore population in nine selected planning areas on single view using trellis display.\nSelection of planning areas In each of the 5 regions, we select 1 largest mature and 1 largest non-mature planning areas, based on number of residents. In East and North regions, only mature or non-mature estates are available, hence, 2 planning areas of the same maturity are selected in these 2 regions."
  },
  {
    "objectID": "Take_Home_Exercise/Take_Home_Exercise_1/Take_Home_Exercise_1.html#dataset",
    "href": "Take_Home_Exercise/Take_Home_Exercise_1/Take_Home_Exercise_1.html#dataset",
    "title": "Take Home Exercise 1",
    "section": "2. Dataset",
    "text": "2. Dataset\nThe dataset used, Singapore Residents by Planning Area / Subzone, Age Group, Sex and Type of Dwelling, June 2022, can be retrieved from the Singapore Department of Statistics home page.\n\n\n\nFigure above shows csv file on SingStats website\n\n\nAdditional information on regions and maturity of the planning areas were referenced from Wikipedia and PropertyGuru Singapore to provide more insights to the readers. The additional information consolidated can be retrieved from Github."
  },
  {
    "objectID": "Take_Home_Exercise/Take_Home_Exercise_1/Take_Home_Exercise_1.html#preparation-steps",
    "href": "Take_Home_Exercise/Take_Home_Exercise_1/Take_Home_Exercise_1.html#preparation-steps",
    "title": "Take Home Exercise 1",
    "section": "3. Preparation Steps",
    "text": "3. Preparation Steps\n\n3.1 Preparing the data in Tableau\n\n\n\n\n\n\n\n\nStep\nDescription\nScreenshot\n\n\n\n\n1.\nLoad the csv file into Tableau.  Click “Connect to Data”, select “Text file” and choose the CSV file to connect to\n\n\n\n2.\nView the Notes.  Click on “View data” beside “Notes” for the view data screen to appear.\n\n\n\n3.\nRename the columns according to the data in Notes.  In the viewing panel on the right, click the down arrow button beside each field name and select “Rename” to change the name according to table shown in step 2.\n\n\n\n4.\nSave the Tableau file.  Click on “Save” button\n\n\n\n5.\nAdding additional information on region and maturity.  Click “Add” and select “Microsoft Excel” to choose the file to add.\n\n\n\n6.\nBuild the connection with “Maturity”.  1. Drag “Maturity” to the right until a line is form to connect to the original data.2. Select “Planning Area” = “Planning Area1”\n\n\n\n7.\nBuild the connection with “Region”.  1. Drag “Region” to the right until a line is form to connect to the original data.2. Select “Planning Area” = “Planning Area (Region)”\n\n\n\n\n\n\n3.2 Select 9 planning areas\n\n\n\n\n\n\n\n\nStep\nDescription\nScreenshot\n\n\n\n\n1.\nSelecting the 9 planning areas based on highest resident count and when possible, choose 1 mature and 1 non-mature area in each region. 1. Click on sheet 1, drag “Region” into Columns and drag “Planning Area” and “Maturity” into Rows, then place “Resident Count” as the table content.2. Sort each region to find out the planning areas with highest resident count.The 9 selected planning areas: Central - Bukit Merah (Mature)East - Bedok (Mature), Tampines (Mature)North - Woodlands (Non-mature), Yishun (Non-mature)North-East - Sengkang (Non-mature), Ang Mo Kio (Mature)West - Jurong West (Non-mature), Clementi (Mature)\n\n\n\n2.\nApply filter to dataset.  Drag “Planning Area” into filter, select the 9 planning areas listed in previous step and click “Apply”.\n\n\n\n3.\nApply filter to all worksheets.  Click on “Planning Area” under filter, select “Apply to Worksheets” and “All Using This Data Source”.\n\n\n\n\n\n\n3.3 Plotting the charts\n\n\n\n\n\n\n\n\nStep\nDescription\nScreenshot\n\n\n\n\n1.\nCreate calculated field for female and male resident count  Under Analysis, click “Create Calculated Field”, create a calculated field - “Female” by keying in the formula shown on the right, then repeat the step and create another calculated field - “Male”.\n\n\n\n2.\nCreate the base for age-sex pyramids  Drag “Females” and “Males” onto Columns and drag “Age Group” onto Rows.\n\n\n\n3.\nCreate calculated field - Index  Under Analysis, click “Create Calculated Field”, create a calculated field - “Index” by keying in the formula shown on the right.\n\n\n\n4.\nCreate parameter - Number of Columns  On Data panel, right click on empty space and select “Create Parameter…”On Edit Parameter screen, change the name and key in Current value of 2\n\n\n\n5.\nCreate calculated field - Columns  Under Analysis, click “Create Calculated Field”, create a calculated field - “Columns” by keying in the formula shown on the right.Once the calculated field “Columns” is created, right click on it on the Data panel, and select “Convert to Discrete”\n\n\n\n6.\nBuild trellis display  1. Drag “Columns” to Columns and drag “Region” to Rows 2. Drag “Planning Area” to Detail 3. Right click on “Planning Area” under Detail and select compute using “Planning Area”\n\n\n\n7.\nEdit X-Axis of “Females”  1. Right click “Females” on X-axis and select “Edit Axis”. 2. Select “Fixed” under range and set Fixed start to 0 and Fixed end to 14000. Check “Reversed” under Scale. 3. Navigate to “Tick Marks”, set Major Tick Marks to “Fixed” and set Tick interval to 2000.\n\n\n\n8.\nEdit X-Axis of “Males”  Right click “Males” on X-axis and select “Edit Axis”. 1. Select “Fixed” under range and set Fixed start to 0 and Fixed end to 14000.  2. Navigate to “Tick Marks”, set Major Tick Marks to “Fixed” and set Tick interval to 2000.\n\n\n\n9.\nChange fill and border colors  Click on color, select red fill and border line for “Females” and blue for “Males” for more intuitive visualization.\n\n\n\n10.\nSort the charts by resident counts  1. Drag “Resident Count” onto Tooltip2. Right click on “Planning Area” under “All” panel, and select Sort3. Select sort by “Field” and set Field Name as “Resident Count”4. Click on the triangle icon beside Region under Rows, Select sort by “Field” and set Field Name as “Resident Count”\n\n\n\n\n\n\n3.4 Creating calculated fields for additional insights\n\n\n\n\n\n\n\n\nStep\nDescription\nScreenshot\n\n\n\n\n1.\nCreate calculated field - Female-to-Male Ratio  Under Analysis, click “Create Calculated Field” to create a calculated field - “Female-to-Male Ratio” by keying in the formula shown on the right.\n\n\n\n2.\nGroup type of dwelling into public, private and others 1. Right click on Type of Dwelling, select “Create” and the “Group” 2. Select the respective dwelling types and click Group, once all the 3 groups have been formed, click “Apply”.\n\n\n\n3.\nCreate calculated field - Public/Private Ratio Under Analysis, click “Create Calculated Field” to create a calculated field - “Public/Private Ratio” by keying in the formula shown on the right.\n\n\n\n4.\nCreate calculated field - Top Age Group Under Analysis, click “Create Calculated Field” to create 2 calculated fields - “TopAgeGroup-Female” and “TopAgeGroup-Male” by keying in the formula shown on the right.\n\n\n\n5.\nCreate calculated field - Window Resident Count Under Analysis, click “Create Calculated Field” to create a calculated field - “Window Resident Count” by keying in the formula shown on the right.\n\n\n\n6.\nAdd a line plot on Female-to-Male ratio Drag “Female-to-Male Ratio” to Columns, click on the triangle icon and select compute using “Cell”. Right click on the X-Axis for line plot, select “Edit Axis” to edit the title to “F/M Ratio”\n\n\n\n\n\n\n3.5 Adding labels and tooltips\n\n\n\n\n\n\n\n\nStep\nDescription\nScreenshot\n\n\n\n\n1.\nCreate AVG(1) Type AVG(1) into Columns.\n\n\n\n2.\nChange chart type and color opacity Click on the dropdown button beside “Bar” and select “Line”. Then click on Color and adjust opacity to 0%.\n\n\n\n3.\nAdding labels 1. Drag “Planning Area”, “Maturity”, “Window Resident Count”, “Female-to-Male ratio” and “public/private ratio” onto Label2. Right click on “Maturity” and select “Attribute”\n\n\n\n4.\nEdit label 1. Click on “Label” and click 2. Edit Label according to the screenshot on the right.\n\n\n\n5.\nEdit tooltip for AVG(1) 1. Click on Tooltip and edit tooltip according to the screenshot on the right.\n\n\n\n6.\nEdit X-Axis for AVG(1) Right click on AVG(1) on the X-axis1. Select “Uniform axis range for all rows or columns”, check “Reversed” under Scale, and remove the axis title.2. Navigate to “Tick Marks”, select “None” under Major Tick Marks\n\n\n\n7.\nAdd labels for “Males” (Max) 1. Drag Resident count onto Label under SUM(Males), click the dropdown and select “Add Table Calculation”2. Select “Percent of Total as Calculation Type and compute using”Pane (down)“3. Click on Label and check”Show mark labels, select “Min/Max” and uncheck “Label minimum value”\n\n\n\n8.\nAdd labels for “Females” (selected) 1. Drag “Females”, “Males” and “Resident Count” onto Label under SUM(Females), click the dropdown and select “Add table calculation”2. Select “Percent of Total as Calculation Type and compute using”Pane (down)“3. Click on Label and check”Show mark labels and select “Selected”\n\n\n\n9.\nHighlight the top age group in each planning area Drag “TopAgeGroup-Female” to color under SUM(Females) and drag “TopAgeGroup-Male” to color under SUM(Males)\n\n\n\n10.\nAdjust tooltips for SUM(Females) and SUM(Males) Drag “Females”, “Males”, “Female-to-Male ratio” and “Maturity” onto tooltip under both SUM(Females) and SUM(Males). Edit the tooltip as shown on the right.\n\n\n\n11.\nAdd label for F/M Ratio  Drag “Females-to-Males ratio” onto Label, click on Label, check “Show mark labels”, select “Min/Max” and deselect “Label minimum value”.\n\n\n\n\n\n\n3.6 Formatting\n\n\n\n\n\n\n\n\nStep\nDescription\nScreenshot\n\n\n\n\n1.\nChange sheet name Double click on sheet name to rename, type in “Trellis: Age-Sex Pyramids”.\n\n\n\n2.\nHide field labels for Columns Right click on “Columns” and select “Hide Field Labels for Columns”.\n\n\n\n3.\nHide header Right click on “1” or “2” at the column header and deselect “Show Header”.\n\n\n\n4.\nFormat column shading and fonts Right click on column/row header, select “Format” and edit the shading, font size, and bold the header font.\n\n\n\n5.\nAnnotate Right click on the empty area on the chart, select “Annotate” and “Area”, type in the text shown on the right and adjust the size of the box to fit the empty area.\n\n\n\n\n\n\n3.7 Dashboarding\n\n\n\n\n\n\n\n\nStep\nDescription\nScreenshot\n\n\n\n\n1.\nAdd new dashboard Click on  at the bottom of the page to create a new dashboard. Drag “Trellis: Age-Sex Pyramid” sheet from the Dashboard panel onto the space in the right. Under Size, select “Automatic”\n\n\n\n2.\nEdit title Double click on the title to edit the title to “Trellis Display: Age-Sex Pyramids of 9 planning areas located in 5 regions in Singapore in 2022”\n\n\n\n3.\nAdd descriptive text Drag “Text” from the Objects panel onto the charts. Adjust the height of the text box, double click on the text box to key in the text as shown on the right.\n\n\n\n\n\n\n3.8 Publishing to Tableau Public\n\n\n\n\n\n\n\n\nStep\nDescription\nScreenshot\n\n\n\n\n1.\nExtract Data Under Data, select “Extract Data” and save the .hyper file.\n\n\n\n2.\nPublish to Tableau Public Under Server, select “Tableau Public” and “Save to Tableau Public”."
  },
  {
    "objectID": "Take_Home_Exercise/Take_Home_Exercise_1/Take_Home_Exercise_1.html#trellis-display-age-sex-pyramids",
    "href": "Take_Home_Exercise/Take_Home_Exercise_1/Take_Home_Exercise_1.html#trellis-display-age-sex-pyramids",
    "title": "Take Home Exercise 1",
    "section": "4. Trellis Display: Age-Sex Pyramids",
    "text": "4. Trellis Display: Age-Sex Pyramids\n\nThe interactive visualization can now be viewed on Tableau Public."
  },
  {
    "objectID": "Take_Home_Exercise/Take_Home_Exercise_1/Take_Home_Exercise_1.html#key-observations",
    "href": "Take_Home_Exercise/Take_Home_Exercise_1/Take_Home_Exercise_1.html#key-observations",
    "title": "Take Home Exercise 1",
    "section": "5. Key Observations",
    "text": "5. Key Observations\n1. Population size varies greatly across planning areas (PA), outer edges of Singapore more populated. From the trellis display, we observed that Bedok, Tampines, Jurong West, Sengkang, Woodlands and Yishun are significantly more populous than the other 3 PAs. We have mapped out the locations as shown below and observed that the more populous PAs are all located at outer edges of Singapore, and the 3 less populous PAs are either located near to or in Central Region.   2. Mature estates have larger proportion of aged residents. The 3 mature PAs - Bukit Merah, AngMoKio and Clementi have 16.5%, 16.1% and 14.6% of their residents above 70 years old respectively. These proportions are much higher as compared to the 4 non-mature PAs (Woodlands, Yishun, Sengkang, Jurong West), with only 6.51% to 8.69% of their residents age above 70. This observation is consistent with the PA’s maturity. As mature PAs have been around for longer (>20 years), it’s logical to have composition of older residents. Although the 2 mature PAs in East Region (Bedok, Tampines) have slightly lower proportion of residents above 70, at 13.75% and 9.58% respectively, their proportion of residents above 60 is at a similar level to that of Bukit Merah, AngMoKio and Clementi.\n3. In the same region, non-mature PAs are more populated than mature PAs. For regions with both mature and non-mature PAs, the biggest non-mature PA in the region has significantly more residents than the biggest mature PA in the same region. This is observed from both West and North-East Region. The biggest non-mature PA in West Region, Jurong West is 1.75x more populous than Clementi, the biggest mature PA in the West. Also, Sengkang, the biggest non-mature PA in North-East Region has 57% more residents than the biggest mature PA in North-East, Ang Mo Kio.\n4. High proportion of young families in Yishun, Woodlands, Sengkang and Tampines. As evident from the trellis chart, these 4 PAs seem to be preferred by younger residents in their 20s and 30s. Besides, these PAs also have higher proportion of children under 10, as compared to other selected PAs. This indicates a pool of relatively younger families residing in these 4 PAs.\n5. Shift in age distribution after age 70, with Females-to-Males ratio peaks after age 90 across all PAs. The line charts show that female-to-male ratio follows a constant uptrend after age 70, with female population more than double the male population at age 90 onward. This is unsurprising as statistics have shown that females have longer average life expectancy than males in Singapore. Additionally, a small bulge is also observed on the female-to-male ratio at age 30s to 40s, and the reason behind this bulge might be worth investigating.\n6. Bedok has highest proportion of private housing, while Woodlands has highest proportion of HDB dwellers. In 2022, approximately 20% of residents resided in private housing in Singapore. Given this statistic, Bedok seems to be more prestige as 36.7% of residents here resided in private housing. Of all the private housing residents in Singapore, 11.3% of them reside in Bedok. Woodlands, on the other hand, has 92.3% of its residents residing in public housing."
  },
  {
    "objectID": "Take_Home_Exercise/Take_Home_Exercise_1/Take_Home_Exercise_1.html#future-work",
    "href": "Take_Home_Exercise/Take_Home_Exercise_1/Take_Home_Exercise_1.html#future-work",
    "title": "Take Home Exercise 1",
    "section": "6. Future Work",
    "text": "6. Future Work\nThe above observations are extracted based on only 9 selected PAs, we can expand this study to all 55 PAs to find out if some of the observations persist."
  },
  {
    "objectID": "Take_Home_Exercise/Take_Home_Exercise_2/Take_Home_Exercise_2.html",
    "href": "Take_Home_Exercise/Take_Home_Exercise_2/Take_Home_Exercise_2.html",
    "title": "Take Home Exercise 2",
    "section": "",
    "text": "In this take-home exercise, a selected Tableau visualization submitted by classmate in take-home exercise 1 is reviewed based on its clarity and aesthetics. Constructive suggestions are given based on data visualization design principles and best practices learned in Lesson 1 and 2. An alternative design is also proposed to help improve on the original visual. Instead of Tableau, the proposed design is produced using ggplot2, ggplot2 extensions and tidyverse packages."
  },
  {
    "objectID": "Take_Home_Exercise/Take_Home_Exercise_2/Take_Home_Exercise_2.html#original-visualization",
    "href": "Take_Home_Exercise/Take_Home_Exercise_2/Take_Home_Exercise_2.html#original-visualization",
    "title": "Take Home Exercise 2",
    "section": "2. Original visualization",
    "text": "2. Original visualization\nThe original visualization was done using Tableau and can be viewed on Tableau Public. Figure below shows a screenshot of the original visual.   The dataset used, Singapore Residents by Planning Area / Subzone, Age Group, Sex and Type of Dwelling, June 2022, can be retrieved from the Singapore Department of Statistics’ website."
  },
  {
    "objectID": "Take_Home_Exercise/Take_Home_Exercise_2/Take_Home_Exercise_2.html#review-on-original-visualization",
    "href": "Take_Home_Exercise/Take_Home_Exercise_2/Take_Home_Exercise_2.html#review-on-original-visualization",
    "title": "Take Home Exercise 2",
    "section": "3. Review on original visualization",
    "text": "3. Review on original visualization\nThis section is divided into 3 parts for easy reading.  In 3.1, the merits of original visual are identified for peer learning, followed by 3.2, where the focus is shifted to point out the areas of improvement on clarity, and lastly, 3.3, where the aesthetics aspect of the visual is discussed.\n\n3.1 Merits of the original visual\n\na. Clean background was used.\nIn the original visualization, a white background was used, allowing viewers to clearly see all the pyramid charts and labels at one glance.\n\n\nb. The charts are clearly labelled.\nThe x-axis, y-axis and all 9 planning areas were labelled accordingly, with all labels in horizontal writing that is easy for viewers to read.\n\n\nc. Appropriate use of pyramid chart.\nAs the intention of the dashboard is to showcase the age and gender distribution of the selected planning areas, the use of pyramid chart type is appropriate and suitable for comparison.\n\n\nd. The intention of the dashboard is clear to viewers.\nAs the same colors were used for male and female across the 9 pyramids, it is obvious to viewers that the 9 pyramids on the dashboard are of the same structure, and the intention is for viewers to easily compare the shape of the 9 pyramids.\n\n\n\n3.2 Clarity\n\na. Absence of clear title – difficult for viewers to comprehend the visual at first glance.\nThe dashboard lacks a title to describe the content of the visual. Even though a short name, “Singapore Population Distribution by Age”, was given to the Viz in Tableau, it does not provide enough context for viewers and hence, can be misleading. For example, based on the short name given, viewers who are unfamiliar with Singapore might assume that the charts include the age distribution of the entire Singapore’s population. In addition, the date of this data is unclear. As demographic data is ever changing, the title should also indicate the date of the data to prevent any confusion.\n\n\nb. Two different scales were used on the x-axes – might result in misleading comparisons.\nThe scales of x-axes differ for male and female population, and across the different planning areas. When doing comparison, viewers who are not aware of this difference could accidentally draw misleading insights. Taking Punggol’s pyramid as example, the bar of female residents in age group 35-39 has the same length as the bar of male residents in the same age group. However, the tooltip shows that there are 63k female residents and only 55k male residents in this age group.\n\n\n\n\n\n\n\nAgain, comparing between Choa Chu Kang and Punggol, judging solely from the length of the bars, both highlighted bars seem to have similar length, however, the number of residents in these two highlighted rows differs by 11k - Choa Chu Kang has 43,140 female residents and Punggol has 54,700 female residents.\n\n\n\n\n\nc. Number of residents shown on charts looks inflated.\nAdding up the number of residents in each age group, the original visualization shows that Bedok has a total of 1.46million residents. This number seems a bit dubious as according toSingStats, there were only 4.07million residents in Singapore as of June 2022. Adding up all the number of residents shown in the 9 planning areas in original visualization would have exceeded the total number of residents in Singapore. With the dataset used in take-home exercise 1, I have tabulated the number of residents by planning areas. As shown in the table below, Bedok has a total of 278k residents only, this does not tally with the original visual.\n\n\n\n\n\nHowever, we are unable to investigate this further as the original source of data used in the original visual was not provided, and the date of original data was not stated as well.\n\n\nd. Absence of legend for color gradient, and gradient intensity is relative to bars within the same pyramid, not across pyramids.\nThe original visualization included color gradient on the pyramid charts. However, there is no legend to describe the gradient, leaving it to the viewers to assume. When inspected closely, we realise that the gradient intensity is with relative to the other bars within the same pyramid, rather than across all 9 pyramids. This might mislead viewers when making comparison. Furthermore, as the length of the bars in the pyramids are already indicating the number of residents in each age group, color gradients might just be an extra element that competes for viewers’ attention.\n\n\n\n3.3 Aesthetics\n\na. Color options can be more intuitive.\nThe 2 colors used in the original visualization to represent male and female population can be made more intuitive. We can choose to align the color selection with common color associations that the general public have, i.e. blue for male and red/pink for female. This will help viewers to better associate and reduce the need for viewers to repeatedly refer to x-axis label for guidance.\n\n\nb. Charts of the 9 planning areas are not aligned.\nThe 9 pyramid charts seem to have been added to the dashboard one-by-one, resulting in different axis widths and misalignment of the charts. This affects the aesthetics of the dashboard, making it look disorganized and unprofessional.\n\n\nc. Overlapping y-axis labels.\nThe labels of the age groups on y-axis overlap each other, making it difficult for viewers to read. Some of the y-axis titles were cut off as well due to the different axis widths.\n\n\nd. Some longer bars in the pyramids were cropped off.\nAs shown in the screenshot below, the 2 highlighted bars seem to have been cropped off on the right. Even though the number of residents were provided in tooltips, this affects the aesthetics of the visual and the viewing experience.\n\n\n\n\n\n\n\ne. Repeated x-axis and y-axis labels.\nThe x-axis and y-axis labels should be the same across all 9 pyramids. Repeating the axis labels for 9 times makes the dashboard look congested."
  },
  {
    "objectID": "Take_Home_Exercise/Take_Home_Exercise_2/Take_Home_Exercise_2.html#proposed-visualization",
    "href": "Take_Home_Exercise/Take_Home_Exercise_2/Take_Home_Exercise_2.html#proposed-visualization",
    "title": "Take Home Exercise 2",
    "section": "4. Proposed Visualization",
    "text": "4. Proposed Visualization\nThe proposed visualization retains the merits of the original visualization while improving on the clarity and aesthetics. Below is a rough sketch of the proposed visualization.\n\n\n\n\n4.1 Key improvements.\n\na. Clear title - indicating context and date.\nA clear title “Age-sex pyramids of top 9 planning areas by population count in Singapore, June 2022” is included for viewers to quickly grasp the context of the charts.\n\n\nb. Single scale on shared x-axis and shared y-axis.\nInstead of using separate axes with different scales, the proposed visual is plotted on shared x and y axis. This allows viewers to compare across the different planning areas easily, without having to worry about the different axis scales.\n\n\nc. More intuitive colors.\nUse blue for males and pink for females to align to common color associations.\n\n\nd. Organized layout with proper alignment.\nThe title, labels, legends, and charts are properly positioned, sized and aligned.\n\n\ne. Allow comparison with overall resident population.\nThe composite chart under 5(i) allows viewers to easily compare the shape of pyramid of each planning area with the pyramid of entire Singapore resident population."
  },
  {
    "objectID": "Take_Home_Exercise/Take_Home_Exercise_2/Take_Home_Exercise_2.html#the-remake",
    "href": "Take_Home_Exercise/Take_Home_Exercise_2/Take_Home_Exercise_2.html#the-remake",
    "title": "Take Home Exercise 2",
    "section": "5. The Remake",
    "text": "5. The Remake\n\na. Load the required libraries\n\n\nHide the code\npacman::p_load(ggiraph, plotly, patchwork, hrbrthemes, ggthemes, \n               knitr, rmarkdown, flextable, tidyverse)\n\n\n\n\nb. Import the data\n\n\nHide the code\nresults <- 'hide'\ndata2022 <- read_csv(\"respopagesextod2022.csv\")\npaged_table(data2022, options = list(rows.print = 5))\n\n\n\n\n  \n\n\n\n\n\nc. Group data by Planning Areas, Age Group and Sex\n\n\nHide the code\ndata2022$Age_Group <- factor (data2022$Age_Group, \n                              levels = unique(data2022$Age_Group)) \ndata2022$Planning_Areas <- factor (data2022$Planning_Areas, \n                                   levels = unique(data2022$Planning_Areas)) \n\n# Group by Planning Areas, Age Group and Sex\ndata_grp <- data2022 %>%\n                    group_by(`Planning_Areas`, `Age_Group`, `Sex`) %>%\n                    summarise('Population_Count'= sum(`Population`)) %>%\n                    ungroup()\npaged_table(data_grp, options = list(rows.print = 5))\n\n\n\n\n  \n\n\n\n\n\nd. Select the top 9 planning areas by population count\n\n\nHide the code\ntop9PA <- data_grp %>%\n  group_by(Planning_Areas) %>%\n  summarise(count = sum(Population_Count)) %>%\n  arrange(desc(count),.by_group = TRUE) %>%\n  top_n(9,count)\n\ndata_top9 <- data_grp[data_grp$Planning_Areas %in% top9PA$Planning_Areas,]\nprint(unique(data_top9$Planning_Areas))\n\n\n[1] Bedok         Choa Chu Kang Hougang       Jurong West   Punggol      \n[6] Sengkang      Tampines      Woodlands     Yishun       \n55 Levels: Ang Mo Kio Bedok Bishan Boon Lay Bukit Batok ... Yishun\n\n\n\n\ne. Converting population count of males to negative.\nIn order to plot age-sex pyramids, we need to convert the population count for one of the gender to negative. As we want “Male” to appear on the left side of the pyramids (to mimic the original visualization), we convert male population count to negative using the mutate function.\n\n\nHide the code\ndata_all_males <- data_grp %>%\n  filter(`Sex` ==  \"Males\") %>%\n  mutate (Population_Count = -Population_Count)\n\ndata_males <- data_top9 %>%\n  filter(`Sex` ==  \"Males\") %>%\n  mutate (Population_Count = -Population_Count)\n\n\n\n\nf. Combining the converted males population count with female population count.\n\n\nHide the code\ndata_all_females <- data_grp %>%\n  filter(`Sex` ==  \"Females\") \ndata_all_transform <- rbind(data_all_males,data_all_females)\n\ndata_females <- data_top9 %>%\n  filter(`Sex` ==  \"Females\") \ndata_top9_transform <- rbind(data_males,data_females)\n\n\n\n\ng. Plotting the age-sex pyramid of entire Singapore population.\n\n\nHide the code\ndata_all_transform_grp <- data_all_transform %>%\n  group_by(`Age_Group`, `Sex`) %>%\n  summarise('Population_Count'= sum(`Population_Count`)) %>%\n  ungroup()\n\nmy_colors <- c(\"salmon\",\"skyblue\")\npop_lab <- paste0(as.character(c(seq(160, 0, -40), seq(40, 160, 40))),\"k\")\np_all <- ggplot(data_all_transform_grp, aes (x = reorder(Age_Group, desc(Age_Group)), \n                                y = Population_Count, fill = Sex,\n                                text = paste(\"Age Group:\", Age_Group, \"\\nPopulation:\", abs(Population_Count), \"\\nSex\", Sex))) +\n    geom_bar(stat = \"identity\", width = .7) +\n    scale_y_continuous(name = \"Population Count\", breaks = seq (-160000,160000,40000), labels=pop_lab) +\n    xlab(\"Age\\nGroups\") +\n    coord_flip() + \n    theme_bw() + scale_fill_manual(values = my_colors) + \n    ggtitle(\"Age-sex pyramids of Singapore, June 2022\") + \n    theme(axis.title.y= element_text(angle=0),\n          axis.ticks.y = element_blank(),\n          panel.grid.major.y = element_blank(),\n          panel.grid.minor.x = element_line(colour = \"grey85\", linetype = \"dotted\"),\n          plot.title = element_text(size=13, hjust = 0.5),\n          legend.position = \"right\")\n\np_all\n\n\n\n\n\n\n\nh. Plotting the age-sex pyramids of top 9 planning areas\n\n\nHide the code\nxbrks <- seq(-12000, 12000, 3000)\nxlabls <- paste0(as.character(c(seq(12, 0, -3), seq(3, 12, 3))),\"k\")\nmy_colors <- c(\"salmon\",\"skyblue\")\np <-ggplot(data_top9_transform, aes (x = reorder(Age_Group, desc(Age_Group)), \n                                y = Population_Count, fill = Sex, \n                                text = paste(\"Age Group:\", Age_Group, \"\\nPopulation:\", abs(Population_Count), \"\\nSex\", Sex))) +\n    geom_bar(stat = \"identity\", width = .7) +\n    facet_wrap (~ Planning_Areas, nrow = 3, ncol = 3) + \n    scale_y_continuous(breaks = xbrks, labels = xlabls, name = \"Population Count\") +\n    xlab(\"Age\\nGroups\") +\n    coord_flip() + \n    theme_bw() + scale_fill_manual(values = my_colors) + \n    ggtitle(\"Age-sex pyramids of top 9 planning areas by population count in Singapore, June 2022\") + \n    theme(axis.title.y= element_text(angle=0),\n          axis.ticks.y = element_blank(),\n          panel.grid.major.y = element_blank(),\n          panel.grid.minor.x = element_line(colour = \"grey85\", linetype = \"dotted\"),\n          plot.title = element_text(size=13, hjust = 0.5),\n          legend.position = \"none\")\np1 <- p + theme(legend.position = \"right\")\n    \nshow(p1)\n\n\n\n\n\n\n\ni. Creating a composite chart.\n\n\nHide the code\ncolnames(top9PA)[2] <- \"Population Count\"\nmy_theme = gridExtra::ttheme_default(base_size = 12)\ntable <- gridExtra::tableGrob(top9PA, theme = my_theme)\npatch <- (p | table) +\n  plot_layout(widths = unit(c(22, 1),c(\"cm\",\"null\")))\n  \np_all / patch +\n  plot_layout(heights = unit(c(10, 1), c('cm', 'null')))\n\n\n\n\n\n\n\nj. Adding interactivity.\nWe can add interactivity to the plots using ggplotly.\n\n\nHide the code\np2 <- p_all + theme(axis.title.y = element_text(angle=0))\n\np3 <- p1 + theme(axis.text = element_text(size=5.5), \n          axis.title = element_text(size =9),\n          axis.title.y= element_text(angle=0),\n          axis.ticks.y = element_blank(),\n          strip.text = element_text(size=8),\n          plot.title = element_text(size=10, hjust = 0.5),\n          legend.key.size = unit(1, 'cm'),\n          legend.title = element_text(size=9),\n          legend.text = element_text(size=6),\n          legend.position = \"right\") \n\nggplotly(p2, tooltip=\"text\")\n\n\n\n\n\n\nHide the code\nggplotly(p3, tooltip=\"text\")"
  },
  {
    "objectID": "Take_Home_Exercise/Take_Home_Exercise_3/Take_Home_Exercise_3.html",
    "href": "Take_Home_Exercise/Take_Home_Exercise_3/Take_Home_Exercise_3.html",
    "title": "Take Home Exercise 3",
    "section": "",
    "text": "Section 1:Overview\nIn take-home exercise 3, various interactive visualizations are prepared using R packages and functions such as ggiraph, ggplot2, and ggstatsplot to showcase the salient patterns of the Singapore public housing resale prices in 2022. The focus of this exercise is on 4-room and 5-room public houses (HDB flats).\n\n\nSection 2:Data Preparation\nThe main dataset used is obtained from data.gov.sg. Additional information on region, town maturity and distance to mrt are also added to provide more insights to viewers.\n\n2.1. Load the required libraries\nSome required libraries include:\n\nggiraph, plotly: To produce interactive visualization\ntmap: To plot interactive choropleth map\npatchwork: To combine separate ggplots into the same graphic\nheatmaply: To plot interactive heatmaps\nggstatsplot: To create graphics with details from statistical tests\ntidyverse: A suite of data wrangling and visualization packages such as tidyr, ggplot2, knitr and so on\ncrosstalk: To connect HTML widgets and allow them to communicate with each other\n\n\n\nShow the code\npacman::p_load(ggiraph, plotly, patchwork, hrbrthemes, ggthemes, readxl,\n               tmap, ggstatsplot, heatmaply, kableExtra, rmarkdown,\n               RColorBrewer, tidyverse, crosstalk, htmltools, sf)\n\n\n\n\n2.2. Import data\nThe original data is available in csv format. Read_csv function is being used here to read the data. Below shows a snippet of the dataset.\n\n\nShow the code\nhdb_data <- read_csv(\"resale-flat-prices-based-on-registration-date-from-jan-2017-onwards.csv\")\npaged_table(hdb_data, options = list(rows.print = 5))\n\n\n\n\n  \n\n\n\n\n\n2.3. Filter the required data\nFor the purpose of this exercise, the data on year 2022 for 3-room and 4-room resale flats is filtered.\n\n\nShow the code\nhdb2022 <- hdb_data %>%\n  filter(substr(month,1,4) == 2022 & flat_type %in% c(\"3 ROOM\", \"4 ROOM\"))\n\n\n\n\n2.4. Import additional data\nAdditional data on region, town maturity and distance to mrt is imported into R Studio.\n\n\nShow the code\nregion_data <- read_xlsx(\"region.xlsx\")\nmrt_data <- read_csv(\"hdb_data.csv\")\n\n\n\n\n2.5. Join additional data onto hdb_data\nThe additional information on region, town maturity and distance to nearest mrt are joined to the main dataset.\n\n\nShow the code\nhdb_data1 <- left_join(hdb2022, region_data, by = c(\"town\" = \"TOWN\"))\n\nhdb_data1$address = paste(hdb_data1$block,hdb_data1$street_name)\n\nhdb_data_all <- left_join(hdb_data1, mrt_data, by = c(\"address\" = \"address\"))\n\n\n\n\n2.6. Calculate “resale price per sqm” and “remaining lease (year)”\nIn order to perform further analysis, the resale price per sqm is computed by dividing resale_price by floor_area_sqm. Remaining lease in year is also calculated by taking the substring of the remaining_lease column.\n\n\nShow the code\n# Calculating resale price per sqm\nhdb_data_all$price_sqm <- hdb_data_all$resale_price / hdb_data_all$floor_area_sqm\n\n# Calculating remaining lease (year)\nhdb_data_all$remaining_lease_year <- as.numeric(substr(hdb_data_all$remaining_lease,1,3))\n\n\n\n\n2.7. Categorize storey into low, middle, high and super high floor\nThe original storey_range field contains too many categories, making it difficult to analyse. Hence, we re-categorize storey_range into 4 categories.\n\nLevel 3 and below = Low\nLevel 4-9 = Middle\nLevel 10-24 = High\nLevel 25 and above = Super High\n\n\n\nShow the code\nhdb_data_all1 <- hdb_data_all %>% \n  separate(storey_range, into = c(NA, \"storey_low\"), sep = \"TO \", remove = FALSE) %>% \n  mutate(storey = \n           cut(as.numeric(storey_low), \n               breaks = c(1,3,9,24,100),\n               labels = c(\"Low\",\"Middle\",\"High\",\"Super High\")))\n\npaged_table(hdb_data_all1, options = list(rows.print = 5))\n\n\n\n\n  \n\n\n\n\n\n\nSection 3:Exploratory Analysis & Insights\nIn this section, exploratory data analysis is performed using various visualization methods to uncover patterns of the HDB resale market in Singapore and identify the differences between the various flat types and towns.\n\n3.1. Overview of the Singapore HDB resale market\nThis section aims to provide viewers with a basic overview on Singapore 3-room and 4-room HDB resale flats market by visualizing the number of transactions and overall resale prices in 2022.\n\ni. Design Consideration\nThe 2 interactive charts are designed to showcase the overall number of resale transactions in 2022 and the resale price range for both 3-room and 4-room flats across Singapore. Through the visuals, viewers can also identify the differences between the resale market for 3-room vs 4-room flats.\n\nBoxplot is used to display the resale price range, viewers can easily identify the difference in resale prices range between both flat types.\nTooltips shows information on mean, median, minimum, maximum, lower and upper quartile price.\nBar chart is used to clearly display the number of transaction for each flat type.\nMean resale prices are plotted (white dot on boxplot) for viewers to easily compare mean and median.\nThe boxplot and bar chart are coordinated for viewers to have multiple view when hover over the 2 flat types.\n\n\n\nii. Preparation Steps: Coordinated boxplot and bar chart for overview\n\n\nShow the code\n# Boxplot displaying the statistic summary of resale prices for 3-room and 4-room HDB.\n\n# specifying ybreaks and ylables\nybrks <- seq(200000, 1500000, 100000)\nylabls <- paste0(as.character(c(seq(200, 1500, 100))),\"k\")\n\n# customizing the appearance of tooltips\ntooltip_css <- \"background-color:white;padding:8px;border-radius:10px 10px 10px 10px;\nfont-style:bold; color:black;\"\n\n# Calculating the stats for tooltips\nstats <- hdb_data_all %>% \n  group_by(flat_type) %>% \n  summarise(\n        Min = prettyNum(min(resale_price),\n                        big.mark = \",\", scientific = FALSE),\n        Q1 = prettyNum(quantile(resale_price, 0.25),\n                       big.mark = \",\", scientific = FALSE),\n        Median = prettyNum(median(resale_price),\n                           big.mark = \",\", scientific = FALSE),\n        Mean = prettyNum(mean(resale_price),\n                         big.mark = \",\", scientific = FALSE),\n        Q3 = prettyNum(quantile(resale_price, 0.75),\n                       big.mark = \",\", scientific = FALSE),\n        Max = prettyNum(max(resale_price),\n                        big.mark = \",\", scientific = FALSE))\n\n# Placing the stats into a table\ntooltip_table <- data.frame(unclass(stats), check.names = FALSE) %>%\n  kableExtra::kable(align = \"c\", booktabs=TRUE, row.names=FALSE, \n                    col.names = c(\"Flat Type\", \"Min\", \"Q1\", \n                                  \"Median\", \"Mean\", \"Q3\", \"Max\")) %>%\n  row_spec(0, color = \"white\", background = \"black\")%>%\n  kable_styling(font_size = 11,bootstrap_options = \"bordered\")\n\n# Plotting the boxplot\np1 <- ggplot(data = hdb_data_all,\n             aes(x=flat_type, y=resale_price, fill = flat_type)) +\n  geom_boxplot_interactive(aes(tooltip=tooltip_table,\n                               data_id=flat_type)) +\n  stat_summary(fun.y=mean, geom=\"point\", shape = 15, color=\"white\")+\n  theme_linedraw() + xlab(\"Flat Type\") +\n  scale_y_continuous(name = \"Resale \\nPrice\", \n                     breaks=ybrks, labels=ylabls) +\n  ggtitle(\"Resale Prices by Flat Type\")+\n  theme(axis.title.y = element_text(angle=0),\n        axis.ticks.x = element_blank(),\n        panel.grid.minor.y = element_line(colour=\"grey85\", \n                                          linetype = \"dotted\"),\n        panel.grid.major.x = element_blank(),\n        plot.title = element_text(size=10, face = \"bold\",hjust=0.5),\n        axis.title = element_text(size =9),\n        legend.position = \"none\")\n\n\n\n\nShow the code\n# Bar chart showing the number of transactions for each flat type\n# Computing the count\nlab <- hdb_data_all %>% group_by (flat_type) %>% tally()\n\n# Plotting the bar chart\np2 <- ggplot(lab,aes(x=flat_type, y=n, fill=flat_type))+\n  geom_bar_interactive(stat=\"identity\", aes(data_id=flat_type, tooltip=paste(\n    \"Number of Transactions =\",format(n,big.mark = \",\", scientific = FALSE))))+\n  geom_text(aes(label=n),vjust=1.3, color = \"white\")+\n  \n  theme_linedraw() + xlab(\"Flat Type\") +\n  scale_y_continuous(name = \"No. of\\nTransactions\") +\n  ggtitle(\"Number of Resale Transactions by Flat Type\")+\n  theme(axis.title.y = element_text(angle=0, hjust=1),\n        axis.ticks.x = element_blank(),\n        panel.grid.minor.y = element_line(colour = \"grey85\", linetype = \"dotted\"),\n        panel.grid.major.x = element_blank(),\n        plot.title = element_text(size=10, face = \"bold\", hjust=0.5),\n        axis.title = element_text(size =9),\n        legend.position = \"none\")\n\n# Making the charts interactive with coordinating views\ngirafe(\n  code = print((p1+p2)+\n                 plot_annotation(\n                   title=\"Overview of HDB Resale Market, Singapore 2022\",\n                   subtitle = \"Comparison between 3-room and 4-room HDB\",\n                   caption=\"Data on 2022 Singapore resale prices from Data.gov.sg\",\n                   theme = theme(plot.title = element_text(face = \"bold\", size = 13),\n                                 plot.caption = element_text(face = \"italic\", size=7))\n                 )),\n  width_svg = 8,\n  height_svg = 8*0.618,\n  options = list(\n    opts_hover_inv(css = \"opacity:0.2;\"),\n    opts_hover(css = \"none\"),\n    opts_tooltip(css = tooltip_css)\n  )\n)\n\n\n\n\n\n\n\n\n\n\n\n\n\nInsights\n\n\n\n\n\nIn 2022,\n\nSingapore has more 4-room resale transactions than 3-room’s transactions.\n4-room resale price ranges from S$288k to S$1.37mil and is average at S$549k.\n3-room resale price ranges from S$200k to S$958k and is average at S$389k.\n\n\n\n\n\n\n\n3.2. Average resale prices vs number of transactions for each town.\nThis visualization showcases the resale prices and number of transactions by town for each flat type. It helps viewers understand the differences between town.\n\ni. Design Consideration\nThe 2 charts are interactive and coordinated. Each town is represented by a point and viewers can hover over each point to view the mean resale price and total number of resale transactions in 2022 in the specific town.\n\nScatter plot is chosen to cleanly visualize all the towns and present the relationship between mean resale price and number of transactions, a fitted line is also drawn to show the overall relationship.\nThe individual points are intentionally kept unlabeled to prevent cluttering on the chart. Instead, tooltip is used to present the required details.\nThe 2 charts are coordinated and drawn with the same scale to allow viewers to easily compare the differences between 3-room and 4-room resale market for each town.\n\n\n\nii. Preparation Steps: Scatter plot showing the relationship between resale price and number of transactions.\n\n\nShow the code\n# As the number of towns in dataset exceed the number of colors in palatte,\n# colorRampPalette is used to generate more colors.\ncolourCount = length(unique(hdb_data_all$town))\ngetPalette = colorRampPalette(brewer.pal(12, \"Paired\"))\n\n# Preparing the data for scatter plot\nscatter_data <- hdb_data_all %>% \n  group_by(town, flat_type) %>% \n  summarise(mean_price = round(mean(resale_price),1), trsn_number = n()) \n\n# Specifying the break and label for yaxis\nybrks1 <- seq(200000, 1000000, 100000)\nylabls1 <- paste0(as.character(c(seq(200, 1000, 100))),\"k\")\n\n# Plotting the scatter plot\nscatter <- ggplot(scatter_data, aes(x=trsn_number, y=mean_price)) +\n  geom_point_interactive(alpha = 0.7, aes(colour=factor(town), size = 5, data_id=town, \n                                          tooltip=paste(town,\"\\nNo. of Transactions: \",\n                                                         format(trsn_number,big.mark = \",\", scientific = FALSE),\n                                                         \"\\nMean Resale Price: \",\n                                                         format(mean_price,big.mark = \",\", scientific = FALSE)))) +\n  scale_colour_manual(values = getPalette(colourCount)) +\n  geom_smooth_interactive(method=lm, se=FALSE, col='lightblue',\n                          aes(tooltip=\"fitted line\", data_id=\"smooth\")) + \n  theme_linedraw() +\n  xlab(\"Number of Transactions\")+\n  labs(caption=\"Data on 2022 Singapore resale prices from Data.gov.sg\")+\n  scale_y_continuous(name = \"Mean\\nResale Price\", \n                     breaks=ybrks1, labels=ylabls1) +\n  ggtitle(\"Mean Resale Price vs Number of Resale Transactions by Flat Type, Singapore 2022\") +\n  theme(axis.title.y = element_text(angle=0),\n        panel.grid.major.y = element_line(colour=\"black\", \n                                          linetype = \"dotted\"),\n        panel.grid.major.x = element_line(colour=\"black\", \n                                          linetype = \"dotted\"),\n        panel.grid.minor.y = element_blank(),\n        panel.grid.minor.x = element_blank(),\n        plot.title = element_text(size=11, hjust=0.5, face = \"bold\"),\n        plot.caption = element_text(face = \"italic\", size=7),\n        axis.title = element_text(size =9),\n        legend.position = \"none\") +\n  \n  # Use facet_wrap to split 3-room and 4-room into 2 plots\n  facet_wrap(~flat_type, ncol = 2)\n\n# Making the plot interactive using girafe\ngirafe(\n  ggobj=scatter,\n  width_svg = 9,\n  height_svg = 7*0.618,\n  options = list(\n    opts_hover_inv(css = \"opacity:0.1;\"),\n    opts_hover(css = \"none\"),\n    opts_tooltip(css = tooltip_css)\n  )\n)\n\n\n\n\n\n\n\n\n\n\n\n\nInsights\n\n\n\n\n\n\nIt seems that there is a negative relationship between average resale price and number of resale transaction, i.e.: towns with more resale transactions have lower average resale price.\nSengkang and Punggol, both located in the North-East region, have the highest number of 4-room resale transactions in 2022, while Bedok and Yishun have the highest number of 3-room resale transactions in 2022. All these 4 locations are located at the edges of Singapore.\nCentral area has the highest average resale price for 4-room, while Pasir Ris has the highest average resale price for 3-room.\nThe difference in 3-room and 4-room average resale price is lowest for Pasir Ris, only close to S$50k (~10%) difference. This is far from the overall average difference in 3-room and 4-room resale price, which is around S$160k (40%). One potential reason for this could be due to other characteristics of the flats, such as age of flats, floor size and location, which are not visualized in this chart.\nFrom this visualization, we know that towns in outskirt areas of Singapore have more resale transactions but lower resale prices, and the difference between 3-room and 4-room resale prices varies across towns.\n\n\n\n\n\n\n\n3.3. Distribution and range of resale prices by town\nUnlike the previous visualization where only the average resale prices for each town are shown, this section allows viewers to gain more insights based on the distribution of resale prices in each town.\n\ni. Design Consideration\n\nA boxplot is chosen to visualize the distribution of resale prices in each town.\nThe boxplot is coordinated with a bar chart showing the number of resale transactions in each town. With the coordinated view, viewers can easily observe the different characteristics of each town. For example, Central Area has third least number of resale transactions but its 4-room resale price boxplot has the longest interquartile range and whisker.\nThe towns are ordered by total number of transaction count on the bar chart and ordered by average resale price on the boxplot.\nMean prices are plotted for viewers to easily compare mean and median.\nTooltip shows maximum, minimum and median prices, median prices are shown instead of mean as mean can be easily influenced by outliers.\n\n\n\nii. Preparation Steps: Coordinated bar chart and boxplot showing resale price distribution by town\n\n\nShow the code\n# Plotting number of transactions by flat type and town\ngroup1<- hdb_data_all %>% group_by (town, flat_type) %>% tally()\n\ncolourCount = length(unique(hdb_data_all$town))\ngetPalette = colorRampPalette(brewer.pal(12, \"Paired\"))\n\np4 <- group1 %>%\n  mutate(town = fct_reorder(town, n, .fun='mean')) %>%\n  ggplot(aes(x=reorder(town, n), y=n, fill=factor(town))) + \n  scale_fill_manual(values = getPalette(colourCount)) +\n  geom_bar_interactive(stat=\"identity\", aes(data_id=town, tooltip=paste(\"Town: \",town,\n    \"\\nNumber of Transactions: \",format(n,big.mark = \",\", scientific = FALSE))))+\n  xlab(\"Towns\") +\n  theme_linedraw() +\n  scale_y_continuous(name = \"Number of \\nTransactions\") +\n  xlab(\"Town\")+\n  theme(axis.title.y = element_text(angle=0),\n        axis.ticks.x = element_blank(),\n        axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),\n        panel.grid.minor.y = element_line(colour = \"grey85\", linetype = \"dotted\"),\n        panel.grid.major.x = element_blank(),\n        plot.title = element_text(size=12, hjust = 0.5),\n        axis.title = element_text(size =9),\n        legend.position = \"none\") +\n  \n  facet_wrap(~flat_type, ncol = 1)\n\n\n\n\nShow the code\n# plotting boxplot of resale price by flat type and town\np3 <- ggplot(data = hdb_data_all,\n             aes(x=reorder(town, resale_price), y=resale_price, fill = town)) +\n  geom_boxplot_interactive(aes(tooltip=after_stat({\n        paste0(\"Min: \", prettyNum(.data$ymin,big.mark = \",\", scientific = FALSE),\n          \"\\nMax: \", prettyNum(.data$ymax,big.mark = \",\", scientific = FALSE),\n          \"\\nMedian: \", prettyNum(.data$middle,big.mark = \",\", scientific = FALSE)\n        )\n      }),\n      data_id=town)) +\n  scale_fill_manual(values = getPalette(colourCount)) +\n  stat_summary(fun.y=mean, geom=\"point\", shape = 3, color=\"white\")+\n  theme_linedraw() +\n  scale_y_continuous(name = \"Resale \\nPrice\", \n                     breaks=ybrks, labels=ylabls) +\n  xlab(\"Town\")+\n  theme(axis.title.y = element_text(angle=0),\n        axis.ticks.x = element_blank(),\n        axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),\n        panel.grid.minor.y = element_line(colour=\"grey85\", \n                                          linetype = \"dotted\"),\n        panel.grid.major.x = element_blank(),\n        plot.title = element_text(size=12, hjust=0.5),\n        axis.title = element_text(size =9),\n        legend.position = \"none\") +\n  facet_wrap(~flat_type,ncol = 1)\n\n# Putting the 2 charts together and have a coordinated view\ngirafe(\n  code = print((p4+p3) + plot_annotation(\n  title = 'Number of Resale Transactions & Resale Prices by Flat Type & Towns, Singapore 2022',\n  subtitle = \"Ordered by transaction count and mean resale price\",\n  caption = \"Data on 2022 Singapore HDB resale prices from Data.gov.sg\",\n  theme = theme(plot.title = element_text(face = \"bold\", size = 15),\n                plot.caption = element_text(face = \"italic\", size=7)))),\n  width_svg = 10,\n  height_svg = 11*0.618,\n  options = list(\n    opts_hover_inv(css = \"opacity:0.2;\"),\n    opts_hover(css = \"none\"),\n    opts_tooltip(css = tooltip_css))\n)\n\n\n\n\n\n\n\n\n\n\n\n\nInsights\n\n\n\n\n\n\nCentral area has the longest resale price boxplot whisker and interquartile range for 4-room flat. Some other towns with long boxplot whisker (huge resale price range) and interquartile range are Clementi, Kallang/Whampoa, Bukit Merah, Toa Payoh, Ang Mo Kio and Geylang. These are all matured towns.\nYishun and Sengkang have the highest number of resale transactions, but the resale price range is relatively small (shorter whisker), which means the resale prices for the same flat type are rather consistent within the town.\nOther towns with relatively shorter whisker and interquartile range include Choa Chu Kang, Sembawang, Bukit Panjang, Pasir Ris, Woodlands, Jurong East and Jurong West. All of these are non-matured towns.\nHence, it is reasonable to hypothesize that resale prices of the same flat type in non-matured towns moves within smaller range as compared to matured towns.\n\n\n\n\n\n\n\n3.4. Geographic representation of towns and their respective resale prices.\nConsidering that not all viewers are familiar with the geographical location of each town in Singapore, a choropleth map is prepared to show where each town is located at.\n\ni. Design Consideration\n\nAn interactive choropleth map with color gradient is chosen to represent the average resale prices of each towns.\nThe mean resale price per sqm is shown using tooltip.\nViewers can deselect the “mpsz_price” layer on the map to view the street view.\n\n\n\nii. Preparation Steps: choropleth map showing the geographical location of town and their resale prices\n\n\nShow the code\n# Calculating mean prices by town\nmean_prices <- hdb_data_all %>%\n  group_by(town) %>% \n  summarise(\"Mean Resale Price Per Sqm\" = mean(price_sqm))\n\n# reading the map file\nmpsz <- st_read(dsn = 'master-plan-2014-subzone-boundary-web-shp',\n                layer = 'MP14_SUBZONE_WEB_PL',\n                crs = 3414) \n\n\nReading layer `MP14_SUBZONE_WEB_PL' from data source \n  `D:\\shiangrou\\ISSS608-VAA\\Take_Home_Exercise\\Take_Home_Exercise_3\\master-plan-2014-subzone-boundary-web-shp' \n  using driver `ESRI Shapefile'\nSimple feature collection with 323 features and 15 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 2667.538 ymin: 15748.72 xmax: 56396.44 ymax: 50256.33\nProjected CRS: SVY21 / Singapore TM\n\n\nShow the code\nsingapore <- st_transform(mpsz, 4326)\n\n\n\n\nShow the code\n# Preparing the choropleth map\nmpsz_price <- left_join(singapore, mean_prices, by = c(\"PLN_AREA_N\" = \"town\"))\ntmap_mode(\"view\")\ntm_shape(mpsz_price)+\n  tmap_options(check.and.fix = TRUE)+\n  tm_fill(\"Mean Resale Price Per Sqm\", id=paste(\"PLN_AREA_N\"),\n          n = 6,\n          style = \"pretty\", \n          palette = \"Greens\") +\n  tm_borders(alpha = 0.7)\n\n\n\n\n\n\n\n\n\n\n\n\n\nInsights\n\n\n\n\n\n\nTowns around south of Singapore carry highest average resale prices per sqm.\nTowns around west of Singapore carry low average resale price per sqm.\n\n\n\n\n\n\n\n\nSection 4:Correlation Analysis and Confirmatory Analysis\nIn this section, correlation analysis is performed to find out the correlation between resale prices and other variables. Then, hypothesis testing is done to evaluate our hypotheses and produce statistical inferences.\n\n4.1. Correlation Analysis\nWith correlation analysis, we aim to answer 2 questions:\n\nWhich of the variables have the highest correlation coefficient with resale prices?\nWhich of the correlation coefficient is statistically significant?\n\nThrough this analysis, viewers can identify the correlated variables. However, do be mindful that correlation does not imply causation.\n\ni. Design Consideration\n\nA correlation matrix is plotted to provide a one-glance view of the pairwise correlation coefficients across the continuous variables.\nThe correlation matrix is color coded with a gradient to clearly show the magnitude of the correlation.\nThe pairwise correlation coefficients are calculated separately for each flat type, as the variables of each flat type might be correlated in different way.\nA significance level of 0.05 is used, for correlation that is not statistically significant, a red cross will be marked on the correlation coefficient.\n\n\n\nii. Preparation Steps:\n\n\nShow the code\n# Selecting all the numeric factors\nhdb_numeric <- hdb_data_all1 %>% \n  select(flat_type, resale_price, storey_low, floor_area_sqm, \n         nearest_distance_to_mrt, remaining_lease_year) %>%\n  rename(\"Resale Price\" = resale_price, \"Storey\"=storey_low, \n         \"Floor Area\"=floor_area_sqm, \n         \"Distance to nearest MRT/LRT\"=nearest_distance_to_mrt, \n         \"Remaining Lease (Year)\"=remaining_lease_year)\nhdb_numeric$Storey <- as.numeric(hdb_numeric$Storey)\n\n# Plotting the correlation matrix\ngrouped_ggcorrmat(\n    data = hdb_numeric,\n    grouping.var = flat_type,\n    hc.order = TRUE,\n    matrix.type = \"lower\",\n    output=\"plot\",\n    plotgrid.args = list(ncol = 2),\n    ggcorrplot.args = list(outline.color = \"black\",\n                           lab_col = \"navy\",\n                           lab_size = 3.2,\n                           pch.col = \"red\",\n                           pch.cex = 1),\n    annotation.args = list(tag_levels = \"i\",\n    title    = \"Pairwise Correlation of Numeric Variables\",\n    subtitle = \"Resale price most highly correlated with remaining lease and storey\",\n    caption = \"Data on 2022 Singapore resale prices from Data.gov.sg\"),\n    ggplot.component = list(theme_void(base_size = 8),\n                            theme(plot.title = element_text(size=12),\n                                plot.subtitle = element_text(size=7),\n                                plot.caption = element_text(size=2),\n                                legend.text = element_text(size=7),\n                                axis.text.x = element_text(size = 8, angle = 90, vjust = 0.5,hjust = 0.9),\n                                axis.text.y = element_text(size = 8, hjust = 1),\n                                strip.text.x = element_text(size = 7),\n                                legend.key.size = unit(3, 'mm')\n                                ))\n    )\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nInsights\n\n\n\n\n\n\nAll pairwise correlations are statistically significant.\n3-room resale price is most highly correlated with remaining lease with correlation coefficient of 0.61. (longer remaining lease, higher resale price)\n4-room resale price is most highly correlated with storey with correlation coefficient of 0.58. (higher floor, higher resale price)\nResale price has a weak negative correlation with distance to nearest train station (the nearer a flat is to a train station, the higher the resale price).\nIt is also observed that floor area is positively correlated with 3-room resale price (0.25) but negatively correlated (-0.05) with 4-room resale price.\nInterestingly, storey and remaining lease has a moderate positive correlation. This could be the result of the taller HDB developments in the more recent years.\nFor 4-room flats, remaining lease has negative correlation with floor area. This could be the result of the smaller flats built in more recent years.\n\n\n\n\n\n\n\n4.2. How much does resale prices increase with longer remaining lease and higher storey in each town.\nFrom 4.1, we saw that resale prices are most highly correlated with remaining lease and storey, hence, we want to find out how sensitive the resale prices is to remaining lease and storey in each town.\n\ni. Design Consideration\n\nHeatmap is used here as it can cleanly visualize 3-dimensional data (Remaining Lease, Town, Resale Price & Storey, Town, Resale Price).\nWith color gradient, viewers can distinctly identify the resale price pattern against remaining lease and storey at each town.\nTooltip is used to provide information on average resale price per sqm.\n\n\n\nii. Preparation Steps:\n\n\nShow the code\n# Creating the dataset required for heatmap\nhdb_by_lease<- hdb_data_all %>%\n  group_by(town, flat_type, remaining_lease_year) %>% \n  summarise(Mean_price_per_sqm = median(price_sqm)) \n\n# group the remaining lease into 7 groups\nhdb_by_lease <- hdb_by_lease %>% \n  mutate(lease_cat = \n           cut(remaining_lease_year, \n               breaks = c(0,39,49,59,69,79,89,99),\n               labels = c(\"<40 years\",\"40-49 years\",\"50-59 years\",\"61-69 years\",\"70-79 years\", \"80-89 years\", \"90-99 years\")))\n\n# plotting the heatmap for remaining lease\nheatmap1 <- ggplot(data = hdb_by_lease, \n                  mapping = aes(x = town, y = lease_cat,fill = Mean_price_per_sqm)) +\n            geom_tile_interactive(stat=\"identity\", \n                                  aes(data_id=town,tooltip=paste(town,\"\\n\",lease_cat,\"\\nMean Price Per Sqm: \", \n                                                                 prettyNum(round(Mean_price_per_sqm,0), \n                                                                           big.mark = \",\", scientific = FALSE)))) +\n  labs(title = \"Heatmap showing resale price/sqm by remaining lease and storey\", y = \"Remaining \\nLease\") +\n  scale_fill_distiller(name = \"Mean Resale Price per Sqm\", palette = \"Purples\",direction=1)+\n  theme_linedraw() +\n  theme(axis.title.y = element_text(angle=0),\n        axis.title.x = element_blank(),\n        axis.ticks.x = element_blank(),\n        axis.ticks.y = element_blank(),\n        axis.text.x = element_text(size = 6, angle = 90, vjust = 0.5, hjust=1),\n        axis.text.y = element_text(size = 6),\n        panel.grid.major.y = element_blank(),\n        panel.grid.major.x = element_blank(),\n        plot.title = element_text(size=12, hjust=0.5),\n        axis.title = element_text(size =9),\n        legend.key.height= unit(0.5, 'cm'),\n        legend.key.width= unit(1.8, 'cm'),\n        legend.title = element_text(size=8),\n        legend.text = element_text(size=6),\n        legend.position = \"top\") +\n  \n  facet_wrap(~flat_type)\n\n\n\n\nShow the code\n# Creating the dataset required for heatmap\nhdb_by_storey<- hdb_data_all %>%\n  group_by(town, flat_type, storey_range) %>% \n  summarise(Mean_price_per_sqm = median(price_sqm)) \n\n# plotting the heatmap for storey\nheatmap2 <- ggplot(data = hdb_by_storey, \n                  mapping = aes(x = town, y = storey_range,fill = Mean_price_per_sqm)) +\n            geom_tile_interactive(stat=\"identity\", aes(data_id=town,tooltip=paste(town,\"\\n\",storey_range,\"\\nMean Price Per Sqm: \",prettyNum(round(Mean_price_per_sqm,0), big.mark = \",\", scientific = FALSE))))+\n  labs(caption = \"Data on 2022 Singapore resale prices from Data.gov.sg\", x = \"Town\", y = \"Storey\") +\n  scale_fill_distiller(name = \"Mean Resale Price per Sqm\", palette = \"YlGn\", direction=1)+\n  theme_linedraw() +\n  theme(axis.title.y = element_text(angle=0),\n        axis.ticks.x = element_blank(),\n        axis.ticks.y = element_blank(),\n        axis.text.x = element_text(size = 6, angle = 90, vjust = 0.5, hjust=1),\n        axis.text.y = element_text(size = 6),\n        panel.grid.major.y = element_blank(),\n        panel.grid.major.x = element_blank(),\n        plot.title = element_text(size=12, hjust=0.5, face=\"bold\"),\n        plot.caption = element_text(size=7, face = \"italic\"),\n        axis.title = element_text(size =9),\n        legend.key.height= unit(0.5, 'cm'),\n        legend.key.width= unit(1.8, 'cm'),\n        legend.title = element_text(size=8),\n        legend.text = element_text(size=6),\n        legend.position = \"top\") +\n  \n  facet_wrap(~flat_type)\n\n# Putting the 2 heatmap together and have a coordinated view\ngirafe(\n  code = print(heatmap1/heatmap2),\n  width_svg = 6,\n  height_svg = 12*0.618,\n  options = list(\n    opts_hover_inv(css = \"opacity:0.05;\"),\n    opts_hover(css = \"none\"),\n    opts_tooltip(css = tooltip_css)\n  )\n)\n\n\n\n\n\n\n\n\n\n\n\n\nInsights\n\n\n\n\n\n\nIn line with previous correlation analysis, the heatmap shows that generally, longer remaining lease and higher storey command higher resale prices per sqm (darker color).\nHowever, kallng/whampoa 3-room resale prices show an unusual trend where flats with short remaining lease of below 50 years command higher prices as compared to flats with 50-89 remaining years.\nIt is observed that the price differential varies across town. Price differential for different remaining lease group is relatively lower in towns like Yishun, Woodlands, Jurong East and Jurong West, which are all non-mature towns nearer to the North and West edges of Singapore.\nTowns like Sembawang, Sengkang and Punggol do not have resale transactions with remaining lease of less than 70 years, indicating that these are newer residential towns.\nPrice differential for different storey vaires across town as well, with central area 4-room showing the biggest resale price differential between low floor and super high floor. For towns like Yishun, Woodlands, Sengkang, Sembawang, Punggol, Jurong East, and Jurong West, the price differential is relatively lower than the price differential in other towns.\nNot all towns have super high floor. Towns like Yishun, Pasir Ris, Tampines, Serangoon, and Bukit Timah seem to have only shorter HDB. While Central Area has the tallest high-rise HDB.\n\n\n\n\n\n\n\n4.3. Do the mean prices differ across regions and town maturity?\nIn the previous sections, we observed that resale prices seem to vary across towns. Hence, we form our hypotheses and perform hypothesis tests to find out if the means between groups are significantly different.\n\ni. Design Consideration\nFirst set of hypotheses: H0 : The mean resale prices are equal across 5 regions. H1 : The mean resale prices are not equal across 5 regions.\nSecond set of hypotheses: H0 : The mean resale prices are equal between mature and non-mature towns. H1 : The mean resale prices are not equal between mature and non-mature towns.\n\nNon-parametric tests are used as we are unsure if the prices are normally distributed.\nTo prevent cluttering the charts, only the p-value of non-significant pairs are shown at the top of the chart.\n\n\n\nii. Preparation Steps:\n\n\nShow the code\n# plot mean prices by region\ns1 <- grouped_ggbetweenstats(\n  data = hdb_data_all,\n  x = Region, \n  y = price_sqm,\n  grouping.var = flat_type,\n  xlab = \"Region\",\n  ylab = \"Mean Resale Price\",\n  type = \"np\",\n  pairwise.comparisons = TRUE,\n  pairwise.display = \"non-significant\",\n  k =2,\n  messages = FALSE,\n  plotgrid.args = list(nrow = 1),\n  ggtheme = ggplot2::theme_bw(),\n  annotation.args = list(title = \"Mean Resale Price across Regions, Singapore 2022\",\n                         subtitle = \"Only 2 pairs under 3-Room are not statistically significant\"),) +\n  scale_fill_manual(values = getPalette(colourCount))\n\n\n\n\nShow the code\n# plot mean prices by town maturity\ns2 <- grouped_ggbetweenstats(\n  data = hdb_data_all,\n  x = Maturity, \n  y = price_sqm,\n  grouping.var = flat_type,\n  xlab = \"Town Maturity\",\n  ylab = \"Mean Resale Price\",\n  type = \"np\",\n  pairwise.comparisons = TRUE,\n  pairwise.display = \"all\",\n  k =2,\n  messages = FALSE,\n  plotgrid.args = list(nrow = 1),\n  ggtheme = ggplot2::theme_bw(),\n  annotation.args = list(title = \"Mean Resale Price by Town Maturity, Singapore 2022\",\n                         subtitle = \"The pairs are statistically significant\")) +\n  scale_fill_manual(values = getPalette(colourCount))\n\n\n\n\nShow the code\n# Putting the 2 charts together using patchwork\ns1/s2 + plot_annotation(\n  title = 'Confirmatory Analysis: Testing the differences in mean resale prices across groups, 2022',\n  subtitle = \"Tests for different regions and town maturity\",\n  caption = \"Data on 2022 Singapore resale prices from Data.gov.sg\",\n  theme = theme(plot.title = element_text(face = \"bold\", size = 15),\n                plot.subtitle = element_text(size=12),\n                plot.caption = element_text(face = \"italic\", size = 7))\n)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nInsights\n\n\n\n\n\n\nFor first set of hypothesis test (across regions): at 95% confidence level, we reject the null hypothesis and infer that the mean resale prices across 5 regions are not equal for both 3-room and 4-room. For pairwise analysis, 2 pairs of regions under 3-room have p-value > 0.05 (not enough statistical evidence to reject the null hypothesis), hence, we can infer that the 3-room mean resale prices are equal between East & North, and between Central & North-East.\nFor second set of hypothesis (mature vs non-mature): at 95% confidence level, we reject the null hypothesis and infer that the mean resale prices are not equal between mature and non-mature towns.\nFrom the violin plots, it is also observed that Central region has the longest tail, indicating the highest price differential (largest resale price range).\nMature towns also have longer tail, indicating higher price differential (largest resale price range) as compared to non-mature towns. This is in line with the observation in section 3.3.\n\n\n\n\n\n\n\n\nSection 5:Quick interactive guide for home buyers\nWith the insights and inferences obtained from section 3 & 4, two visualization tools are designed for viewers to gain insights quickly and make clear and well-informed decision when selecting a resale flat based on their budgets and preferences.\n\n5.1. Multi-dimentsion bubble plot showing remaining lease, price per sqm and floor level by town\nIn this section, a bubble plot is designed for viewers to easily view the average resale prices in each towns, against the key characteristics of the flats. This could help viewers to effectively shortlist the suitable towns for their resale flats.\n\ni. Design Consideration\n\nThe bubble charts contain information about the 2 variables (storey and remaining lease) that are most highly correlated to resale price.\nThe bubbles are coordinated. When viewer hovers to one bubble, the other bubbles representing the same town will be highlighted. This allows viewers to quickly gain insights on the resale price of flats with different characteristics in the same town. With this, viewers can select the town within their budget and see the other options they might have within the town.\nTooltips are used here to indicate the key information\n\n\n\nii. Preparation Steps:\n\n\nShow the code\n# Computing the required fields for bubble plot\nbubble_data <- hdb_data_all1 %>% \n  group_by(town, flat_type, storey) %>% \n  summarise(mean_price_per_sqm = mean(price_sqm), mean_lease = mean(remaining_lease_year)) %>%\n  arrange(desc(mean_lease))\n\n# Plotting the bubble plot\nbubble <- ggplot(bubble_data, aes(x=mean_lease, y=mean_price_per_sqm, size=mean_price_per_sqm, fill= storey)) +\n  geom_point_interactive(aes(data_id=town, tooltip=paste(town,\"\\n\",storey,\"floor\\nMean Price/sqm: \",\n                                                         prettyNum(round(mean_price_per_sqm,0),big.mark=\",\"))), \n                         alpha = 0.5, shape=21, color=\"black\") +\n  scale_size(range=c(.1,18),name=\"Mean Price per Sqm\") +\n\n  theme_linedraw() +\n  ylab(\"Avg. Price \\nper Sqm\") +\n  xlab(\"Avg. Lease Remaining\")+\n  theme(axis.title.y = element_text(angle=0),\n        panel.grid.major.y = element_line(colour=\"black\", \n                                          linetype = \"dotted\"),\n        panel.grid.major.x = element_line(colour=\"black\", \n                                          linetype = \"dotted\"),\n        panel.grid.minor.y = element_blank(),\n        panel.grid.minor.x = element_blank(),\n        plot.title = element_text(size=12, hjust=0.5),\n        axis.title = element_text(size =9),\n        legend.title = element_text(size=8),\n        legend.text = element_text(size=8),\n        legend.position = \"right\") +\n  scale_fill_viridis(discrete=TRUE, option=\"D\") +\n  \n  facet_wrap(~flat_type)\n\n# Making the bubble plot interactive with girafe\ngirafe(\n  ggobj=bubble + plot_annotation(\n  title = 'Interactive Bubble Plot for Town Selection',\n  subtitle = \"Avg. Reasle Price vs Avg. Lease Remaining for Each Town\",\n  caption = \"Data on 2022 Singapore HDB resale prices from Data.gov.sg\",\n  theme = theme(plot.title = element_text(face = \"bold\", size = 15),\n                plot.caption = element_text(face = \"italic\", size=7))),\n  width_svg = 8,\n  height_svg = 8*0.618,\n  options = list(\n    opts_hover_inv(css = \"opacity:0.1;\"),\n    opts_hover(css = \"none\"),\n    opts_tooltip(css = tooltip_css)\n  ) \n)\n\n\n\n\n\n\n\n\n\n5.2 Interactive tool with easy filtering and flat details\nViewers who have specific preferences in mind for their resale flats can use this tool to help them shortlist the specific HDB blocks or addresses that fit their criteria. This tool is also suitable for viewers who would like to see more details about each resale transaction.\n\ni. Design Consideration\n\nFilter fields are built-in on the left, allowing viewers to freely calibrate based on their preferences and selection criteria. The selection made on filter will be reflected directly on the scatter plot.\nScatter plot is prepared to visualize each resale transaction. Viewers will be able to directly select the specific transaction(s) on the scatter plot using rectangular or lasso brush. Information about the selected resale transactions on the scatter plot will be shown in the table.\nTooltip on scatter plot is designed to showcase all relevant information about the resale transactions.\nViewers will also be able to filter directly from the table to find transactions that fit their preferences and criteria.\n\n\n\nii. Preparation Steps: Scatter plot with filter and datatable\n\n\nShow the code\n# Extract the required columns\nselected_col <- hdb_data_all1 %>%\n  select(Region, town, address, resale_price, flat_type, storey_range, storey,\n         floor_area_sqm, flat_model, lease_commence_date, remaining_lease, \n         nearest_mrt, nearest_distance_to_mrt)\n\n# Building interactive filters\nd <- highlight_key(selected_col)\n\nfilter_tools <- htmltools::div(\n  filter_select(\"town\", \"Town\", d, ~town),\n  filter_checkbox(\"flat_type\", \"Flat Type\", d, ~flat_type, inline = TRUE),\n  filter_slider(\"lease_commence_date\", \"Lease Commence Year\", d, ~lease_commence_date),\n  filter_slider(\"nearest_distance_to_mrt\", \"Distance to Nearest MRT/LRT\", d, ~nearest_distance_to_mrt),\n  filter_checkbox(\"storey\", \"Storey\", d, ~storey, inline = TRUE))\n\n# plotting interactive scatter plot using plotly\np <- plot_ly(data=d,\n        type= \"scatter\",\n        mode= \"markers\",\n        x= ~lease_commence_date, \n        y= ~resale_price,\n        color= ~storey,\n        colors= \"Accent\",\n        marker= list(size=5, opacity = 0.5,\n                     line=list(width=0.2, color=\"black\")),\n        text= ~paste(\"Town:\",town,\n                     \"\\nYear:\",lease_commence_date,\n                     \"\\nLocation:\",address,\n                     \"\\nType:\",flat_type,\n                     \"\\nResale Price:\",prettyNum(resale_price,big.mark=\",\"),\n                     \"\\nStorey:\",storey_range,\n                     \"\\nNearest MRT:\",nearest_mrt,\" ~\",nearest_distance_to_mrt,\"km\"\n                     )) %>% \n  layout(title = list(text=\"<b>Resale Price vs Lease Commencement Year, Singapore 2022</b>\"),\n         hoverlabel = list(align = \"left\"),\n         legend = list(orientation = \"h\", y = 1, x = 0),\n         xaxis = list(title=\"Lease Commencement Year\"),\n         yaxis = list(title=\"Resale Price (S$)\")) \n\ngg <- highlight(p, \"plotly_selected\")\n\n\n# Using crosstalk bscols to put all 3 elements (filter, scatter plot, datatable) together.\ncrosstalk::bscols(filter_tools,gg,DT::datatable(d, class= \"display\",\n                                                filter=list(position=\"top\", clear=FALSE),\n                                                options=list(pageLength = 10,scrollY = TRUE,\n                                                             iDisplayLength = 25),\n                                                ),\n                  widths = c(3,9,12),\n                  annotations = list(caption = \"Data from Data.gov.sg\"))\n\n\n\n\n\n\n\n\nTown\n\n\n\n\n\n\nFlat Type\n\n\n\n3 ROOM\n\n\n\n4 ROOM\n\n\n\n\n\nLease Commence Year\n\n\n\n\nDistance to Nearest MRT/LRT\n\n\n\n\nStorey\n\n\n\nLow\n\n\n\nMiddle\n\n\n\nHigh\n\n\n\nSuper High\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nData from Data.gov.sg\n\n\n\n\n\n\n\n\nBonus Section:The impact of cooling measure on HDB resale transactions and prices\nOn 30 Sept 2022, Singapore government implemented cooling measure with the aim to moderate the heated residential property market and ensure housing affordability. In this section, we want to find out if the cooling measure did achieve it’s stated objective.\n\n\nShow the code\n# Computing the count and avg price per sqm\nhdb_month <- hdb_data_all %>% \n  group_by (month, flat_type) %>% \n  summarise(mean_price_per_sqm = round(mean(price_sqm),0), trsn_number = n()) \n\n# Plotting the chart\np5 <- ggplot(hdb_month,aes(x=month, y=trsn_number, fill=flat_type))+\n  geom_bar_interactive(stat=\"identity\", aes(data_id=month, tooltip=paste(\n    \"Number of Transactions =\",format(trsn_number,big.mark = \",\", scientific = FALSE))))+\n  geom_text(aes(label=trsn_number),vjust=1.5, size=2.5, color = \"white\")+\n  geom_point_interactive(aes(x=month,y=mean_price_per_sqm/10,data_id=month,\n                             tooltip=paste(\n    \"Avg. price per sqm =\",format(mean_price_per_sqm,big.mark = \",\", scientific = FALSE))),\n                         stat=\"identity\",color=\"red\", size=2)+\n  geom_vline_interactive(xintercept=\"2022-10\",lwd=0.5,colour=\"grey55\",linetype=\"dashed\",\n                         tooltip=\"Cooling Measure from 30 Sep 2022\",\n                         show.legend = TRUE) + \n  annotate(\"text\",x=\"2022-10\",y=20,label=\"Cooling Measure\", size=3, angle=90, hjust=0)+\n  theme_linedraw() + xlab(\"Month\") +\n  scale_y_continuous(name = \"No. of\\nTransactions\",\n                     sec.axis=sec_axis(trans=~.*10,name=\"Avg.\\nResale Price\\nper Sqm\")) +\n  ggtitle(\"Number of Resale Transactions & Average Resale Price per Sqm by Month\")+\n  theme(axis.title.y = element_text(angle=0, hjust=1),\n        axis.title.y.right = element_text(angle=0, vjust=1, hjust=0),\n        axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=0.5),\n        axis.ticks.x = element_blank(),\n        panel.grid.minor.y = element_line(colour = \"grey85\", linetype = \"dotted\"),\n        panel.grid.major.x = element_blank(),\n        plot.title = element_text(size=12, face = \"bold\", hjust=0.5),\n        axis.title = element_text(size =9),\n        legend.position = \"none\") +\n  facet_wrap(~flat_type)\n\ngirafe(\n  ggobj=p5,\n  width_svg = 8,\n  height_svg = 7*0.618,\n  options = list(\n    opts_hover_inv(css = \"opacity:0.3;\"),\n    opts_hover(css = \"none\"),\n    opts_tooltip(css = tooltip_css)\n  )\n)\n\n\n\n\n\n\n\n\n\n\n\n\nInsights\n\n\n\n\n\n\nA sharp drop in number of transactions is observed for both flat type at the start of the cooling measure. However, the number of transactions seem to have climbed back pretty quickly in the subsequent 2 months.\nAverage resale prices per sqm did not appear to vary much after the cooling measure.\nThat being said, the impact of cooling measure might not be obvious over the shorter term. Hence, study should be done over a longer period for more insights."
  },
  {
    "objectID": "Take_Home_Exercise/Take_Home_Exercise_4/Take_Home_Exercise_4.html#section-1-overview",
    "href": "Take_Home_Exercise/Take_Home_Exercise_4/Take_Home_Exercise_4.html#section-1-overview",
    "title": "Take Home Exercise 4",
    "section": "Section 1: Overview",
    "text": "Section 1: Overview\nIn this take home exercise, we study the import, export and trade balance of Singapore during the covid era (from 2020 to 2022) and apply appropriate visualization tools to uncover the impact of Covid-19 and political dynamic on Singapore trade."
  },
  {
    "objectID": "Take_Home_Exercise/Take_Home_Exercise_4/Take_Home_Exercise_4.html#section-2-data-preparation",
    "href": "Take_Home_Exercise/Take_Home_Exercise_4/Take_Home_Exercise_4.html#section-2-data-preparation",
    "title": "Take Home Exercise 4",
    "section": "Section 2: Data Preparation",
    "text": "Section 2: Data Preparation\nThe datset used in this exercise can be downloaded from Deaprtment of Statistics Singapore. The Excel file contains Singapore monthly import and export data from 1976 to 2022.\n\n2.1. Load the required packages\nSome required packages include:\n\nggiraph: To produce interactive visualization\npatchwork: To combine separate ggplots into the same graphic\nlubridate: To work with date-times data (eg: parsing of date)\nggaminate: To create animated ggplots\ntidyverse: A suite of data wrangling and visualization packages such as tidyr, ggplot2, knitr and so on\nggHoriPlot: To build horizon plots\nCGPfunctions: to create slope graph\ncrosstalk: To connect HTML widgets and allow them to communicate with each other\n\n\n\nShow the code\npacman::p_load(readxl, rmarkdown, tidyverse, ggiraph, viridis, lubridate, scales,\n               patchwork, data.table, gganimate, CGPfunctions, ggHoriPlot, ggthemes)\n\n\n\n\n2.2. Import data\nThe Excel file contains 2 sheets, “T1” (import data) and “T2” (export data), we load both sheets into R separately.\ni. Import\n\n\nShow the code\n# Load \"import\" data, replace \"na\" with 0 and convert all fields to numeric.\nimport = read_excel(\"outputFile.xlsx\", \"T1\", skip=9)[1:119,] %>%\n  rename(\"trade_partner\"=\"Data Series\")\nimport[,-1] %>%\n  mutate_all(funs(str_replace(.,\"na\",\"0\")))\n  \nimport[2:ncol(import)] = lapply(import[2:ncol(import)], FUN = function(y){as.numeric(y)})\n\n\n\n\nShow the code\n# print the import table\npaged_table(import, options = list(rows.print = 5))\n\n\n\n\n  \n\n\n\nii. Export\n\n\nShow the code\n# Load \"export\" data, replace \"na\" with 0 and convert all fields to numeric.\n\nexport = read_excel(\"outputFile.xlsx\", \"T2\", skip=9)[1:91,] %>%\n  rename(\"trade_partner\"=\"Data Series\")\nexport[,-1] %>%\n  mutate_all(funs(str_replace(.,\"na\",\"0\"))) \n\nexport[2:ncol(export)] = lapply(export[2:ncol(export)], FUN = function(y){as.numeric(y)})\n\n\n\n\nShow the code\n# print the export table\npaged_table(export, options = list(rows.print = 5))\n\n\n\n\n  \n\n\n\n For the purpose of this exercise, only data from January 2020 to December 2022 is studied. The below code chunk extracts the required data.\n\n\nShow the code\n# Extract only the required dates\nimport_filt <- import[,1:37]\nexport_filt <- export[,1:37]\n\n# Multiply row 2-7 by 1000 so that all values are standardized to be in Thousand Dollars\nimport_filt[2:7,-1] <- import_filt[2:7,-1]*1000\nexport_filt[2:7,-1] <- export_filt[2:7,-1]*1000\n\n# remove unnecessary characters from trade_partner column\nimport_filt$trade_partner <- gsub(\"Million Dollars|Thousand Dollars|[\\\\(|\\\\))]\",\"\",as.character(import_filt$trade_partner)) %>% str_trim(\"right\")\nexport_filt$trade_partner <- gsub(\"Million Dollars|Thousand Dollars|[\\\\(|\\\\))]\",\"\",as.character(export_filt$trade_partner)) %>% str_trim(\"right\")\n\n\n We transpose the table to get total import and total export columns for plotting.\n\n\nShow the code\n# Transpose the import dataframe\nimport_total <- as.data.frame.table(t(import_filt[1,-1])) %>%\n  rename_with(.cols=1,~\"Date\") %>%\n  select(Date,Freq) %>%\n  rename_with(.cols=2,~\"total_import\")\n\n# Transpose the export dataframe\nexport_total <- as.data.frame.table(t(export_filt[1,-1])) %>%\n  rename_with(.cols=1,~\"Date\") %>%\n  select(Date,Freq) %>%\n  rename_with(.cols=2,~\"total_export\") \n\n# Join the 2 datasets\nall_total <- left_join(import_total, export_total, by = \"Date\") %>% map_df(rev)\npaged_table(all_total, options = list(rows.print = 5))\n\n\n\n\n  \n\n\n\n The below code converts the “Date” column to date format and derive the “month” and “year” fields\n\n\nShow the code\n# convert to date format\nall_total$Dates <- parse_date_time(all_total$Date, orders=c(\"Yb\",\"%Y %b\",\"%Y%b\",\"Y b\"))\n\n# derive year\nall_total$year <- year(ymd(all_total$Dates))\n\n# derive month\nall_total$month <- factor(month(all_total$Dates),\n                        levels=1:12,\n                        labels=month.abb,\n                        ordered=TRUE)"
  },
  {
    "objectID": "Take_Home_Exercise/Take_Home_Exercise_4/Take_Home_Exercise_4.html#section-3-overview-of-singapore-export-import-and-trade-balance",
    "href": "Take_Home_Exercise/Take_Home_Exercise_4/Take_Home_Exercise_4.html#section-3-overview-of-singapore-export-import-and-trade-balance",
    "title": "Take Home Exercise 4",
    "section": "Section 3: Overview of Singapore export, import and trade balance",
    "text": "Section 3: Overview of Singapore export, import and trade balance\nMerchandise trade volume and trade balance might not be a topic that everyone is familiar with, hence, it’s important to provide viewers some basic understanding on the topic of study before any detailed analysis.  In this section, we leverage on interactive visualizations to provide viewers with an overview of Singapore trades for the past 3 years.\nThe data covered in this exercise include:\n\nTotal import across time\nTotal export across time\nTrade balance across time (Total Exports − Total Imports)\n\nNote: A positive trade balance (export > import) is known as trade surplus, whereas a negative trade balance (export < import) is known as trade deficit.\n\n3.1. One-glance view of data with key news events\nIn 3.1, we use ribbon chart to showcase import, export and trade balance. The main reason why ribbon chart is chosen is because it can clearly display all the 3 information in 1 chart and it helps viewers grasp the trend pretty quickly.\nHowever, using ribbon plot has it’s cons as well. While it produces beautiful visual, some viewers might misinterpret the chart as described in this SAS blog post. We took this into consideration when designing the chart to ensure it is as clear to all and as easy to interpret as possible.\n\na. Design Consideration\n\nClear title to inform viewers that the chart is plotted using monthly data.\nMarkers are added on the line chart to mark each data point clearly.\nTooltips are used to indicate the months, import, export and trade balance values in the month.\nHover effect is used so that when viewers hover to a particular point, other points belonging to other months will be made transparent, intentionally focusing the viewer’s attention on the export and import values of the same month to prevent misinterpretation as mentioned in the article above.\nNews events with tooltips are added using vertical lines for viewers to enjoy a quick one glance view of key related events and observe any shift in trade pattern around the event period.\nColor selection for trade balance is made intuitive, with green representing trade surplus and red representing trade deficit.\n\n\n\nShow the code\n# specifying ybreaks and ylables\nybrks <- seq(30000000, 70000000, 2000000)\nylabls <- paste0(as.character(c(seq(30, 70, 2))),\"bn.\")\n\n# customizing the appearance of tooltips\ntooltip_css <- \"background-color:white;padding:8px;border-radius:10px 10px 10px 10px;\nfont-style:bold; color:black;\"\n\np <- ggplot(all_total) +\n  geom_point_interactive(aes(x=Dates, y=total_export, data_id=Dates, color=\"Export\", \n                             tooltip=paste(year, month, \"\\nExport:\", prettyNum(total_export, big.mark=\",\"),\n                                           \"\\nTrade Balance\",prettyNum(total_export-total_import, big.mark=\",\"))),\n                         size=2)+\n  geom_point_interactive(aes(x=Dates, y=total_import, data_id=Dates, color=\"Import\", \n                             tooltip=paste(year, month, \"\\nImport:\", prettyNum(total_import, big.mark=\",\"), \n                                           \"\\nTrade Balance\",prettyNum(total_export-total_import, big.mark=\",\"))),\n                         size=2)+\n  geom_line_interactive(aes(x=Dates, y=total_export),color=\"darkgreen\", size=1) +\n  geom_line_interactive(aes(x=Dates, y=total_import),color=\"grey10\", size=1, linetype=2) +\n  geom_ribbon_interactive(aes(x=Dates, ymin = total_import, ymax = total_export, \n                  fill=total_export>total_import), data = all_total, alpha = 0.3) +\n  scale_colour_manual(name=NULL ,values=c(\"Export\"='black', \"Import\"='red'))+\n  scale_fill_manual(values=c(\"lightgreen\", \"salmon\")) +\n  guides(linetype = \"none\", fill=\"none\") +\n  scale_y_continuous(name = \"Import/ \\n Export/\\n Trade Balance($)\",\n                     breaks=ybrks, labels=ylabls) +\n  theme_bw() +\n  theme(axis.title.y = element_text(size=8, angle=0, hjust=1),\n        axis.title.x = element_text(size=8),\n        panel.grid.major.y = element_line(colour = \"grey95\"),\n        panel.grid.minor.x = element_blank(),\n        panel.grid.minor.y = element_blank(),\n        panel.grid.major.x = element_line(colour = \"grey95\"),\n        legend.position = \"bottom\",\n        legend.title = element_text(size=8)) +\n\n  # adding vertical lines and annotation to showcase key political and covid-related events\n  geom_vline_interactive(xintercept=as.POSIXct(as.Date(\"2020-03-11\")),lwd=0.4,colour=\"red\",linetype=\"dashed\",\n                         tooltip=\"11 March 2020:\\nWHO declared pandemic\",\n                         show.legend = TRUE) + \n  geom_label_interactive(aes(x=as.POSIXct(as.Date(\"2020-03-11\")),y=58000000,label=\"Declared\\nPandemic\"), \n                         tooltip=\"11 March 2020:\\nWHO declared pandemic\",\n             fill=\"red\", size=2.5, angle=0, hjust=0.5, color=\"white\") + \n  \n  geom_vline_interactive(xintercept=as.POSIXct(as.Date(\"2020-02-07\")),lwd=0.4,colour=\"orange\",linetype=\"dashed\",\n                         tooltip=\"7 Feb 2020:\\nSingapore DORSCON level raised to Orange\",\n                         show.legend = TRUE) + \n  geom_label_interactive(aes(x=as.POSIXct(as.Date(\"2020-02-07\")),y=62000000,label=\"DORSCON\\nOrange\"), \n                         tooltip=\"7 Feb 2020:\\nSingapore DORSCON level raised to Orange\",\n             fill=\"orange\", size=2.5, angle=0, hjust=0.5, color=\"black\") +\n  \n  geom_vline_interactive(xintercept=as.POSIXct(as.Date(\"2020-04-07\")),lwd=0.4,colour=\"salmon\",linetype=\"dashed\",\n                         tooltip=\"7 Apr 2020:\\nSingapore started Circuit breaker\",\n                         show.legend = TRUE) + \n  geom_label_interactive(aes(x=as.POSIXct(as.Date(\"2020-04-07\")),y=54000000,label=\"Circuit\\nBreaker\"), \n                         tooltip=\"7 Apr 2020:\\nSingapore started Circuit breaker\",\n             fill=\"salmon\", size=2.5, angle=0, hjust=0.5, color=\"black\") + \n  \n  geom_vline_interactive(xintercept=as.POSIXct(as.Date(\"2020-06-02\")),lwd=0.4,colour=\"#acb770\",linetype=\"dashed\",\n                         tooltip=\"2 Jun 2020:\\nSingapore exited Circuit breaker and moved to Phase 1 reopening\",\n                         show.legend = TRUE) + \n  geom_label_interactive(aes(x=as.POSIXct(as.Date(\"2020-06-02\")),y=50000000,label=\"Reopen\\nPhase 1\"), \n                         tooltip=\"2 Jun 2020:\\nSingapore exited Circuit breaker and moved to Phase 1 reopening\",\n             fill=\"#D7E58C\", size=2.5, angle=0, hjust=0.5, color=\"black\") + \n  \n  geom_vline_interactive(xintercept=as.POSIXct(as.Date(\"2020-07-10\")),lwd=0.4,colour=\"#9fc5e8\",linetype=\"dashed\",\n                         tooltip=\"10 July 2020:\\nSingapore general election\",\n                         show.legend = TRUE) + \n  geom_label_interactive(aes(x=as.POSIXct(as.Date(\"2020-07-10\")),y=62000000,label=\"Singapore\\nElection\"), \n                         tooltip=\"10 July 2020:\\nSingapore general election\",\n             fill=\"lightblue\", size=2.5, angle=0, hjust=0.5, color=\"black\") +\n  \n  geom_vline_interactive(xintercept=as.POSIXct(as.Date(\"2020-12-28\")),lwd=0.4,colour=\"#DD9E7B\",linetype=\"dashed\",\n                         tooltip=\"28 Dec 2020:\\nSingapore entered Phase 3 reopening\",\n                         show.legend = TRUE) + \n  geom_label_interactive(aes(x=as.POSIXct(as.Date(\"2020-12-28\")),y=60000000,label=\"Reopen\\nPhase 3\"), \n                         tooltip=\"28 Dec 2020:\\nSingapore entered Phase 3 reopening\",\n             fill=\"#DD9E7B\", size=2.5, angle=0, hjust=0.5, color=\"black\") +\n  \n  geom_vline_interactive(xintercept=as.POSIXct(as.Date(\"2021-01-27\")),lwd=0.4,colour=\"#bf78bc\",linetype=\"dashed\",\n                         tooltip=\"27 Jan 2021:\\nVaccination for public in Singapore started\",\n                         show.legend = TRUE) + \n  geom_label_interactive(aes(x=as.POSIXct(as.Date(\"2021-01-27\")),y=34000000,label=\"Vaccination\\nstarted\"), \n                         tooltip=\"27 Jan 2021:\\nVaccination for public in Singapore started\",\n             fill=\"#e5c9e4\", size=2.5, angle=0, hjust=0.5, color=\"black\") +\n  \n  geom_vline_interactive(xintercept=as.POSIXct(as.Date(\"2021-12-07\")),lwd=0.4,colour=\"#ada275\",linetype=\"dashed\",\n                         tooltip='07 Dec 2021:\\nUnusual Russian troop movement reported.\n                         US threatened Russia with \"strong measures\" if it invades',\n                         show.legend = TRUE) + \n  geom_label_interactive(aes(x=as.POSIXct(as.Date(\"2021-12-07\")),y=34000000,label=\"War\\nSpeculation\"), \n                         tooltip='07 Dec 2021:\\nUnusual Russian troop movement reported.\n                         US threatened Russia with \"strong measures\" if it invades Ukraine',\n             fill=\"#d0cab0\", size=2.5, angle=0, hjust=0.5, color=\"black\") +\n  \n  geom_vline_interactive(xintercept=as.POSIXct(as.Date(\"2022-02-24\")),lwd=0.4,colour=\"#7e9c7a\",linetype=\"dashed\",\n                         tooltip='24 Feb 2022:\\nRussia invaded Ukraine',\n                         show.legend = TRUE) + \n  geom_label_interactive(aes(x=as.POSIXct(as.Date(\"2022-02-24\")),y=38000000,label=\"Russia-Ukraine\\nwar\"), \n                         tooltip='24 Feb 2022:\\nRussia invaded Ukraine',\n             fill=\"#b5c6b3\", size=2.5, angle=0, hjust=0.5, color=\"black\") +\n  \n  geom_vline_interactive(xintercept=as.POSIXct(as.Date(\"2022-04-26\")),lwd=0.4,colour=\"#f1c232\",linetype=\"dashed\",\n                         tooltip=\"26 Apr 2022:\\nDORSCON level lowered to Yellow\",\n                         show.legend = TRUE) + \n  geom_label_interactive(aes(x=as.POSIXct(as.Date(\"2022-04-26\")),y=42000000,label=\"Singapore DORSCON\\nYellow\"), \n                         tooltip=\"26 Apr 2022:\\nSingapore DORSCON level lowered to Yellow\",\n             fill=\"yellow\", size=2.5, angle=0, hjust=0.5, color=\"black\") \n\n\n# making interactive visual with girafe\ngirafe(\n  ggobj=p + plot_annotation(\n    title=\"Singapore Monthly Trade Balance with key events (2020-2022)\",\n    subtitle = \"Singapore experienced trade surplus over the 3 years\",\n    caption=\"Source:Singstat.gov.sg\",\n    theme = theme(plot.title = element_text(face = \"bold\", size = 13),\n                  plot.caption = element_text(face = \"italic\", size=7))),\n  width_svg = 8.6,\n  height_svg = 8.6*0.618,\n  options = list(\n    opts_hover_inv(css = \"opacity:0.15;\"),\n    opts_hover(css = \"opacity:1;\" ),\n    opts_tooltip(css = tooltip_css)\n  )\n) \n\n\n\n\n\n\n\n\nb. Insights\n\nOverall, imports and exports follow the same ups and downs, and they follow an increasing trend until Sep 2022.\nWithin the 3-year period, merchandise trade volume (import and export) was at the lowest in May 2020, right after circuit breaker started.\nMerchandise trade volume jumped in March 2021, after the start of phase 3 reopening and vaccination for public.\nImport and export experienced a sharp drop in Feb 2022, during the Russia-Ukraine conflict period, but the drop did not last long, with import and export values resumed in March 2022.\n\n\n\n\n3.2. Lollipop chart for easier comparison across time\nIn the previous ribbon chart, it is rather difficult for viewers to compare the trade balance across time as viewers need to either gauge the distance between export and import or hover to the tooltip one by one. As an alternative, a lollipop chart is plotted to clearly display the monthly trade balances using colored segments for easier comparison.\n\na. Design Consideration\n\nLollipop chart shows the import and export value, with gradient-colored segment added to make trade balance values crystal clear to viewers. This allows viewers to easily spot the trend and perform year-on-year (YoY) / month-on-month (MoM) comparison.\nFacet wrap is used to split the time series into individual year to allow easier comparison across time.\nColor gradient with intuitive color selection is used, with darker green segments indicating higher trade surplus.\nHover effect is done such that when viewers hover to one segment, the segments of the same month across different years will be highlighted and the rest of the segments will be dimmed. This allows viewers to easily perform year-on-year (YoY) comparison.\n\n\n\nShow the code\n# Plotting a lollipop chart\np1 <- ggplot(all_total,x=month) +\n  geom_segment_interactive(aes(x=month, xend=month, y=total_import,yend=total_export, \n                               colour=total_export-total_import,\n                               data_id=month,\n                               tooltip=paste(month, year,\"\\nImport:\",prettyNum(round(total_import/1000000,2), big.mark=\",\"),\"Bn\", \n                                             \"\\nExport:\",prettyNum(round(total_export/1000000,2), big.mark=\",\"),\"Bn\", \n                                             \"\\nTrade Balance:\", round((total_export-total_import)/1000000,2),\"Bn\")), size=4.6) +\n  scale_color_gradient_interactive(low=\"#ffe586\",high=\"#1b953d\",labels=comma)+\n  geom_point_interactive(aes(x=month, y=total_import, fill=\"Import\",data_id=month), \n                         size=3.7, color=\"grey20\", stroke=1.7, shape=21, show.legend = TRUE) +\n  geom_point_interactive(aes(x=month, y=total_export, fill=\"Export\",data_id=month), \n                         size=3.7, color=\"grey20\", stroke=1.7, shape=21, show.legend = TRUE) +\n  geom_text_interactive(aes(label=paste0(round((total_export-total_import)/1000000,0),\"Bn\"),\n                                   x=month, y=(total_export-total_import)/2+total_import,\n                            data_id=month,\n                            tooltip=paste(month, year,\"\\nImport:\",prettyNum(round(total_import/1000000,2), big.mark=\",\"),\"Bn\", \n                                             \"\\nExport:\",prettyNum(round(total_export/1000000,2), big.mark=\",\"),\"Bn\", \n                                             \"\\nTrade Balance:\", round((total_export-total_import)/1000000,2),\"Bn\")), \n                        size=2.3, angle=90, color=\"navy\") +\n  scale_y_continuous(name = \"Total Import \\n& Export ($)\",\n                     breaks=ybrks, labels=ylabls) +\n  theme_linedraw() +\n  theme(axis.title.y = element_text(angle=0),\n        axis.ticks.x = element_blank(),\n        axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),\n        panel.grid.major.y = element_line(colour = \"grey75\"),\n        panel.grid.minor.y = element_blank(),\n        panel.grid.major.x = element_line(colour = \"grey60\", linetype = \"dotted\"),\n        axis.title = element_text(size =9),\n        legend.position = \"right\",\n        legend.title = element_text(size=8))+\n  labs(fill = \"Trade\", colour = \"Trade Balance ('000)\", x=\"Month\")+\n  scale_fill_viridis(discrete=TRUE, option=\"A\") +\n  facet_wrap(~year, ncol = 3)\n\n\n# Making the charts interactive with girafe\ngirafe(\n  ggobj=p1 + plot_annotation(\n    title=\"Singapore Monthly Trade Balance (2020-2022)\",\n    subtitle = \"Singapore experienced trade surplus over the 3 years\",\n    caption=\"Source:Singstat.gov.sg\",\n    theme = theme(plot.title = element_text(face = \"bold\", size = 13),\n                  plot.caption = element_text(face = \"italic\", size=7))),\n  width_svg = 9,\n  height_svg = 9*0.618,\n  options = list(\n    opts_hover_inv(css = \"opacity:0.2;\"),\n    opts_hover(css = \"none\"),\n    opts_tooltip(css = tooltip_css)\n  )\n) \n\n\n\n\n\n\n\n\nb. Insights\n\nWithin the 3-year period, trade balance was the highest in August 2020 and March 2021, and lowest in May 2022.\nExport peaked at 64billion in June 2022, while import peaked at 61billion in July 2022.\nFor all the 3 years, both import and export jump in the month of March, follow by a dip in Apr and May, before heading upward again.\nTrade balance doesn’t seem to follow any obvious trend from month to month.\n\n\n\n\n3.3. Cycle plot showing the month-of-the-year effect\nUsing both the charts in 3.1 and 3.2, viewers are able to spot some trends over the 3-year period, but some important monthly patterns might not show up very clearly in the 2 charts. Hence, a cycle plot is added below. Cycle plot is a great choice when it comes to showing both the trends and the month-of-the-year effect.\n\na. Design Consideration\n\n2 sets of cycle plot is created to show the patterns on import and export seperately.\nThe 2 sets of cycle plot are then patched together for a coordinated view for more intuitive exploration.\nAverage import & export lines are added to the respective plots for easy comparison.\n\n\n\nShow the code\nxbrk1 <- seq(2020, 2022, 1)\nxlabl1 <- paste0(as.character(c(seq(2020, 2022, 1))))\n\nexp_hline <- all_total %>% \n  group_by(month) %>%\n  summarise(avgvalue = mean(total_export))\n\np2 <- ggplot() + \n  geom_line_interactive(data=all_total,\n            aes(x=year, y=total_export, \n                group=month, data_id=month), \n            colour=\"navy\",size=1) +\n  geom_hline_interactive(aes(yintercept=avgvalue,data_id=month,\n                             tooltip=paste(\"Mean:\",prettyNum(avgvalue,big.mark=\",\"))), \n             data=exp_hline, \n             linetype=\"dashed\", \n             colour=\"maroon\", \n             size=0.5) + \n  facet_grid(~month) +\n  theme_linedraw() +\n  labs(axis.text.x = element_blank())+\n  scale_x_continuous(breaks=xbrk1, labels=xlabl1) +\n  theme(axis.title.y = element_text(angle=0, size=9,hjust=1),\n        axis.title.x = element_blank(),\n        axis.text.x = element_text(size = 6, angle = 45, vjust = 1, hjust=1),\n        panel.grid.major.y = element_line(colour = \"grey80\", linetype = \"dotted\"),\n        panel.grid.minor.y = element_blank(),\n        panel.grid.major.x = element_line(colour = \"grey80\", linetype = \"dotted\"),\n        panel.grid.minor.x = element_blank())+\n  scale_y_continuous(name = \"Total\\nExport\\n($)\",\n                     breaks=ybrks, labels=ylabls)\n\n\n\n\nShow the code\nimp_hline <- all_total %>% \n  group_by(month) %>%\n  summarise(avgvalue = mean(total_import))\n\np3<-ggplot() + \n  geom_line_interactive(data=all_total,\n            aes(x=year, y=total_import, \n                group=month, data_id=month), \n            colour=\"#1b954f\",size=1) +\n  geom_hline_interactive(aes(yintercept=avgvalue, data_id=month,\n                 tooltip=paste(\"Mean:\",prettyNum(avgvalue,big.mark=\",\"))), \n             data=imp_hline, \n             linetype=\"dashed\", \n             colour=\"maroon\", \n             size=0.5) + \n  scale_x_continuous(breaks=xbrk1, labels=xlabl1) +\n  facet_grid(~month) +\n  theme_linedraw() +\n  labs(axis.text.x = element_blank())+\n  theme(axis.title.y = element_text(angle=0, size=9,hjust=1),\n        axis.title.x = element_blank(),\n        axis.text.x = element_text(size = 6, angle = 45, vjust = 1, hjust=1),\n        panel.grid.major.y = element_line(colour = \"grey85\", linetype = \"dotted\"),\n        panel.grid.minor.y = element_blank(),\n        panel.grid.major.x = element_line(colour = \"grey85\", linetype = \"dotted\"),\n        panel.grid.minor.x = element_blank())+\n  scale_y_continuous(name = \"Total\\nImport\\n($)\",\n                     breaks=ybrks, labels=ylabls)\n\n\n\n\nShow the code\ngirafe(\n  code = print((p2/p3) + plot_annotation(\n  title = \"Singapore Monthly Total Export & Import (2020-2022)\",\n  subtitle = \"Growth in total import & export reversed its course in first and last 2 months of 2021 & 2022\",\n  caption = \"Source:Singstat.gov.sg\",\n  theme = theme(plot.title = element_text(face = \"bold\", size = 13),\n                plot.caption = element_text(face = \"italic\", size=7)))),\n  width_svg = 9,\n  height_svg = 10*0.618,\n  options = list(\n    opts_hover_inv(css = \"opacity:0.2;\"),\n    opts_hover(css = \"none\"),\n    opts_tooltip(css = tooltip_css))\n)\n\n\n\n\n\n\n\n\nb. Insights\n\nImport and export in the month of March to October followed an upward trend.\nFor January and February, import and export dipped in 2021 but grew in 2022.\nFor November and December, import and export increased in 2021 but dropped in 2022.\nIt is interesting to see that in 2022, import and export reversed its course for the first 2 and last 2 months of the year in the opposite direction."
  },
  {
    "objectID": "Take_Home_Exercise/Take_Home_Exercise_4/Take_Home_Exercise_4.html#section-4-singapore-trade-balance-with-major-trade-partners",
    "href": "Take_Home_Exercise/Take_Home_Exercise_4/Take_Home_Exercise_4.html#section-4-singapore-trade-balance-with-major-trade-partners",
    "title": "Take Home Exercise 4",
    "section": "Section 4: Singapore trade balance with major trade partners",
    "text": "Section 4: Singapore trade balance with major trade partners\nBased on Singstat, in 2022, Singapore major trading partners include Mainland China, Malaysia, US, Taiwan, Republic of Korea, Japan, Hong Kong, Thailand, Indonesia, and European Union.  In this section, a few visualizations are prepared to help viewers understand Singapore trades with these major partners over time.\n\n4.1. Racing bar chart - Fun way to visualize changes over time\nRacing bar chart is an animated and highly visual way to present changes over time. It is used here to display the monthly trade balances over the 3-year period in an interesting and fun way to attract viewers’ eyeballs.\n\na. Design Consideration\n\nA horizontal bar chart is used as it is one of the easiest to understand chart even for layman. As this chart is animated, using a complex chart type makes it more difficult for viewers, especially layman, to understand and draw key insights.\nX-axis is intentionally made static (without it moving together with the changes in data) so that viewers can focus on the movements of each bar.\nLabels are used to showcase the country name and the trade balance.\n\n\n\nShow the code\n# Extract the rows for major trading partners\npartners <- c(\"European Union\", \"Mainland China\", \"Taiwan\", \"Republic Of Korea\", \"Hong Kong\",\n              \"Thailand\",\"Indonesia\",\"Malaysia\",\"Japan\",\"United States\")\nimport_majorp <- import_filt %>%\n  filter(trade_partner %in% partners) %>% arrange(trade_partner)\nexport_majorp <- export_filt %>%\n  filter(trade_partner %in% partners) %>% arrange(trade_partner)\n\n# subtract import amount from export amount to derive trade balance\ntrade_bal = as.data.table(as.matrix(export_majorp[,-1])-as.matrix(import_majorp[,-1]))\ntrade_bal <- cbind(trade_partner=import_majorp[1], trade_bal)\n\npaged_table(trade_bal, options = list(rows.print = 5))\n\n\n\n\n  \n\n\n\nTable above shows the trade balance with major trade partners.\n\n\nShow the code\n# Creating the rank and relative value\nbar_data <- trade_bal %>% \n  mutate_at(vars(contains(\"202\")),as.numeric) %>% \n  gather(Date, value, 2:37) \nbar_data$Date <- parse_date_time(bar_data$Date, orders=c(\"Yb\",\"%Y %b\",\"%Y%b\",\"Y b\"))\nbar_data1 <- bar_data %>%\n  group_by(Date) %>%\n  mutate(rank = rank(-value),\n         Value_rel = value/value[rank==1],\n         Value_lbl = paste0(\" \",round(value/1e3))) %>%\n  ungroup()\n\n\n\n\nShow the code\nanim <- ggplot(bar_data1, aes(rank, group = trade_partner, \n                fill = as.factor(trade_partner), color = as.factor(trade_partner))) +\n  geom_tile(aes(y = value/2,\n                height = value,\n                width = 0.9), alpha = 0.8, color = NA) +\n  geom_text(aes(y = value, label = paste(\" \",trade_partner,\"\\n\",Value_lbl)), hjust = 0, color=\"black\") +\n  coord_flip(clip = \"off\", expand = FALSE) +\n  scale_y_continuous(labels = scales::comma) +\n  scale_x_reverse() +\n  guides(color = FALSE, fill = FALSE) +\n  theme(axis.line=element_blank(),\n        axis.text.y=element_blank(),\n        axis.ticks=element_blank(),\n        axis.title.x=element_blank(),\n        axis.title.y=element_blank(),\n        legend.position=\"none\",\n        panel.background=element_blank(),\n        panel.border=element_blank(),\n        panel.grid.major=element_blank(),\n        panel.grid.minor=element_blank(),\n        panel.grid.major.x = element_line(linewidth=.1, color=\"grey80\" ),\n        panel.grid.minor.x = element_line(linewidth=.1, color=\"grey80\" ),\n        plot.title=element_text(size=20, hjust=0.5, face=\"bold\", colour=\"black\"),\n        plot.subtitle=element_text(size=18, hjust=0.5, face=\"italic\", color=\"grey\"),\n        plot.caption =element_text(size=8, hjust=0.5, face=\"italic\", color=\"grey\"),\n        plot.background=element_blank(),\n       plot.margin = margin(2,2, 2, 2, \"cm\")) \n\nanimated <- anim +\n  transition_states(Date, transition_length = 6, state_length = 1) + \n  view_follow(fixed_y = c(-4500000,7500000)) +\n  ease_aes('cubic-in-out') + \n  labs(title = 'Singapore Trade Balance with Major Trade Partners: {closest_state}', \n       x = \"Trade Balance ('000)\",\n       caption=\"Source:Singstat.gov.sg\")\n\nanimate(animated, 500, fps = 19,  width = 800, height = 600, \n        renderer = gifski_renderer(\"gganim.gif\"))\n\n\n\n\n\n\n\nb. Insights\n\nHong Kong stayed at number 1 position (highest trade surplus) throughout the 3 years.\nTaiwan stayed at the last position (highest trade deficit) throughout the 3 years.\nIt has always been a trade surplus with Indonesia throughout the 3 years.\nTrade balances with other partners change between trade surplus and deficit.\n\n\n\n\n4.2. Slope Graph for year-on-year change\nWhile the racing bar chart looks appealing, it might be difficult for viewers to keep track of the changes from year to year. Hence, a slope graph is introduced here to highlight the year-on-year change for each trade partner.\n\na. Design Consideration\n\nEach line represents one trading partner. The lines help to call out the different trends with each partner over time.\nDifferent color is used for each line to help viewers follow the trend easily.\nThe average trade balances in each year are used to plot the graph, and the respective average values are labelled on the lines to give viewers more information.\n\n\n\nShow the code\ntb_yr <- bar_data\ntb_yr$year <- year(ymd(tb_yr$Date))\ntb_year <- tb_yr %>%\n  group_by(trade_partner, year) %>%\n  summarise(mean_tb=round(mean(value),2))\n\nsp <- tb_year %>% \n  mutate(year = factor(year)) %>%\n  newggslopegraph(year, mean_tb, trade_partner,\n                  Title= \"\", SubTitle = NULL,\n                  Caption = NULL)\n\nsp1 <- sp + labs(title = \"Singapore Trade Balance with Major Trade Partners (2020-2022)\",\n                subtitle = \"Highest trade surplus with Hong Kong, highest trade deficit with Taiwan\",\n                caption = \"Source:Singstat.gov.sg\")\nsp1\n\n\n\n\n\n\n\n\n\n\n\nb. Insights\n\nIn line with insights from racing bar chart, Hong kong has the highest trade surplus and Taiwan has the highest trade deficit.\nTrade balances with Taiwan, Japan, United States and Republic of Korea have been dropping year-on-year in the 3-year period.\nOut of the 10 major partners, Indonesia is the one with constant increase in trade balance in the 3-year period.\nTrade balance with Thailand is rather flat across the 3 years. V. Trade balance of European Union and Malaysia followed the same trend year-on-year in the 3-year period.\nTrade balance with Mainland China seems to fluctuate from year to year.\n\n\n\n\n4.3. Heatmap - monthly trade balance at a glance\nTo deep dive into monthly trend, a heatmap is used. The heatmap uses colors and saturation to represent data values, viewers can easily identify the higher or lower values based on color intensity.\n\na. Design Consideration\n\nThe heatmaps are ordered according to the trade balance, allowing viewers to immediately distinguish between trade partners with surplus and deficit.\nIntuitive color is chosen to represent deficit with red and surplus with red\nTooltip is used to show the trade balance value\n\n\n\nShow the code\n# Convert Date to date format\nhori_data <- bar_data\nhori_data$Date <- as.Date(hori_data$Date, \"%Y-%m-%d\")\n\n# create year and month\nhori_data$year <- year(ymd(hori_data$Date))\nhori_data$month <- month(ymd(hori_data$Date))\n\n# Calculate the average for each trade partner\navg_tb <- hori_data %>% \n  group_by(trade_partner) %>%\n  summarise(avgvalue = mean(value)) %>%\n  arrange(desc(avgvalue))\n\n\n\n\nShow the code\n# setting x-axis breaks\nxbrks <- seq(1, 12, 1)\n\n# Plotting the heatmap\nhp <- ggplot(hori_data, \n       aes(month, \n           year, \n           fill = value)) + \ngeom_tile_interactive(aes(data_id = trade_partner,\n                          tooltip=paste(months.Date(Date, abbreviate = TRUE), year, \"\\nTrade Balance:\",\n                                        prettyNum(value, big.mark=\",\"))),\n                      color = \"white\", size = 0.1) + \ntheme_tufte() + \ncoord_equal() +\nscale_x_continuous(breaks=xbrks) +\nscale_fill_gradient(name = \"Trade Balance\",\n                    low = \"#ff1100\", \n                    high = \"green\") +\n  facet_wrap(~factor(trade_partner,levels=c(\"Hong Kong\", \"Indonesia\", \"Mainland China\",\n                                            \"Thailand\", \"United States\", \"Japan\",\n                                            \"Republic Of Korea\", \"European Union\", \n                                            \"Malaysia\", \"Taiwan\")), ncol = 2) +\n  labs(x = \"Month\", y = \"Year\") +\n  theme(axis.ticks = element_blank(),\n        axis.text.x = element_text(size = 8), \n        axis.title.y = element_text(size = 10, angle=0),\n        axis.title.x = element_text(size = 10),\n        plot.title = element_text(hjust = 0.5, size=13, face=\"bold\"),\n        plot.subtitle = element_text(hjust = 0.5, size=12),\n        legend.title = element_text(size = 8),\n        legend.text = element_text(size = 7))\n\nhp1 <- hp + labs(\n     title = \"Singapore Trade Balance with Major Trade Partners (2020-2022)\",\n     subtitle = \"Arrange from highest trade surplus to highest trade deficit\") \n\n# Making the charts interactive with girafe\ngirafe(\n  ggobj=hp1,\n  width_svg = 8,\n  height_svg = 8*0.618,\n  options = list(\n    opts_hover_inv(css = \"opacity:0.2;\"),\n    opts_hover(css = \"none\"),\n    opts_tooltip(css = tooltip_css)\n  )\n) \n\n\n\n\n\n\n\n\nb. Insights\n\nTrade balance with Mainland China and Unites States seem to fluctuate more from month to month as compared to other partners.\nThe month-on-month trade balance changes for all partners do not seem to exhibit any specific trend.\n\n\n\n\n4.4. Monthly trend condensed into a Horizon Plot\nBased solely on the heatmap above, it is rather difficult for viewers to see the monthly trend as the color intensity can be quite close. Hence, a horizon plot is added to display the monthly ups and downs. The beauty of horizon plot is that it allows the time series data for multiple partners to be shown in a relatively condensed way, while still allowing viewers to draw insights & patterns.\n\na. Design Consideration\n\nInstead of the default “midpoint”, “median” is used as origin when plotting the horizon plot. “midpoint” is referring to the value at the midpoint of the time series but this can be difficult for viewers to comprehend, potentially leading to misinterpretation. Also, using the midpoint as origin subject the plot to distortion if extreme peak or valley (outlier) happen at the midpoint. By using median as the origin, viewers can easily understand that green refers to trade balance above median and red refers to trade balance below median, which is more intuitive and less susceptible to outliers.\nIntuitive color of green and red is chosen to showcase positve and negative trade balance.\n\n\n\nShow the code\nggplot(data=hori_data) +\n  geom_horizon(aes(x=Date, y=value), \n               origin = \"median\", \n               horizonscale = 6)+\n  facet_grid(`trade_partner`~.) +\n    theme_few(base_size = 12) +\n  scale_fill_hcl(palette = 'RdYlGn') +\n  theme(panel.spacing.y=unit(0, \"lines\"), \n        strip.text.y = element_text(size = 8, angle = 0, hjust = 0),\n    legend.position = \"none\",\n    axis.text.y = element_blank(),\n    axis.text.x = element_text(size=6.5, angle = 0, hjust=0.5),\n    axis.title.y = element_blank(),\n    axis.title.x = element_blank(),\n    axis.ticks.y = element_blank(),\n    panel.border = element_blank(),\n    plot.title = element_text(size=13, face=\"bold\")) +\n    scale_x_date(expand=c(0,0), date_breaks = \"2 month\", date_labels = \"%b'%y\") +\n  labs(title = 'Singapore Monthly Trade Balance with Major Trade Partners (2020-2022)', \n       subtitle = \"A condensed visualization for trend comparison\",\n       caption=\"Data source:Singstat.gov.sg\")\n\n\n\n\n\n\n\n\n\n\n\nb. Insights\n\nTrade balances with Republic of Korea and Taiwan seem to follow similar trend, where it is above median before June 2021 and below median after June 2021.\nSome prominent peaks and troughs were spotted in trade balance with Hong Kong, Republic of Korea, mainland China and Taiwan, reflecting that their trade balances fluctuated more as compared to the trade balances with other partners."
  },
  {
    "objectID": "Take_Home_Exercise/Take_Home_Exercise_4/Take_Home_Exercise_4.html#section-5-a-snapshot-on-singapores-trade-during-the-covid-era",
    "href": "Take_Home_Exercise/Take_Home_Exercise_4/Take_Home_Exercise_4.html#section-5-a-snapshot-on-singapores-trade-during-the-covid-era",
    "title": "Take Home Exercise 4",
    "section": "Section 5: A snapshot on Singapore’s trade during the covid era",
    "text": "Section 5: A snapshot on Singapore’s trade during the covid era\nLastly, 3 charts were combined to produce a snapshot for viewers who would like to quickly inspect the potential impact of Covid-19 and political dynamic on Singapore trade balance.\n\n\nShow the code\n# Using patchwork to combine 3 charts\n\nsp2 <- sp + labs(title=\"Year-on-year change in trade balance\") +\n  theme(plot.title = element_text(hjust = 0.5, size=12, face=\"bold\"))\nhp2 <- hp + labs(title=\"Monthly trade balance with major partners\") +\n  theme(plot.title = element_text(hjust = 0.5, size=13.5, face=\"bold\"))\n\n(p / (sp2+hp2)) + plot_annotation(title=\"Singapore Trade Balance Snapshot (2020-2022)\", \n                                  caption=\"Data source:Singstat.gov.sg\",\n                                  theme = theme(plot.title = element_text(face = \"bold\", size = 16, hjust=0.5, vjust=0),\n                                                plot.caption = element_text(face = \"italic\", size=8)))"
  },
  {
    "objectID": "Take_Home_Exercise/Take_Home_Exercise_4/Take_Home_Exercise_4.html#summary-of-key-insights",
    "href": "Take_Home_Exercise/Take_Home_Exercise_4/Take_Home_Exercise_4.html#summary-of-key-insights",
    "title": "Take Home Exercise 4",
    "section": "Summary of Key Insights",
    "text": "Summary of Key Insights\n\nOverall, imports and exports follow the same ups and downs, and they follow an increasing trend until Sep 2022.\nWithin the 3-year period, merchandise trade volume was at the lowest in May 2020, right after circuit breaker started. Sharp drop was also observed during the Russia-Ukraine conflict period.\nA sharp jump was observed in merchandise trade volume in March 2021, after the start of phase 3 reopening and vaccination for public.\nFor all the 3 years, both import and export jumped in the month of March, follow by a dip in Apr and May, before heading upward again.\nHong Kong had the highest trade surplus while Taiwan had the highest trade deficit throughout the 3 years.\nTrade balances with Taiwan, Japan, United States and Republic of Korea have been dropping year-on-year in the 3-year period.\nOut of the 10 major partners, Indonesia is the one with constant increase in trade balance in the 3-year period.\nTrade balance with Thailand is rather flat across the 3 years.\nTrade balance with Mainland China and United States seem to fluctuate more from month to month as compared to other partners."
  }
]